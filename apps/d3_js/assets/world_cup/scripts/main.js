!function(t){function e(e){for(var r,u,i=e[0],c=e[1],l=e[2],f=0,d=[];f<i.length;f++)u=i[f],o[u]&&d.push(o[u][0]),o[u]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);for(s&&s(e);d.length;)d.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,i=1;i<n.length;i++){var c=n[i];0!==o[c]&&(r=!1)}r&&(a.splice(e--,1),t=u(u.s=n[0]))}return t}var r={},o={0:0},a=[];function u(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=t,u.c=r,u.d=function(t,e,n){u.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},u.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(t,e){if(1&e&&(t=u(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)u.d(n,r,function(e){return t[e]}.bind(null,r));return n},u.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return u.d(e,"a",e),e},u.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u.p="";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var s=c;a.push([0,1]),n()}([function(t,e,n){n(1),t.exports=n(3)},function(t,e,n){var r=n(2);!function(){"use strict";var t=r.select("#vis-box").append("svg").style("background","#a8bcc7").style("border","1px solid #000").attr("width",1200).attr("height",750).append("g").attr("class","map"),e=r.geoMercator().scale(190).translate([600,475]),n=r.geoPath().projection(e),o=function(){var t=r.select("#vis-box").append("div").attr("class","tooltip"),e=5,n=5;function o(r,o){var a=window.innerWidth,u=window.innerHeight,i=t.node().offsetWidth,c=t.node().offsetHeight;return r+i>a?r-=i+e:r+=e,o+c>u?o-=c+n:o+=n,[r,o]}return{update:function(e,n,a){t.style("display","block"),t.transition().duration(500).ease(r.easeCubicOut).style("opacity",.7),t.html("<h2>Home:".concat(a.value.home,"</h2>\n          <ul>\n            <li>Year:").concat(a.key,"</li>\n            <li>Total Attendance: ").concat(a.value.attendance,"</li>\n            <li>Team Number: ").concat(a.value.teamNumber,"</li>\n          </ul>"));var u=o(e,n);t.style("left",u[0]+"px").style("top",u[1]+"px")},off:function(){t.transition().duration(300).on("end",function(){t.style("display","none")}).ease(r.easeCubicOut).style("opacity",0)},move:function(e,n){var r=o(e,n);t.style("left",r[0]+"px").style("top",r[1]+"px")}}}(),a=function(){var e=void 0,r="#f3e3d4",o="#a8bcc7";return{init:function(a){return e=t.selectAll("path").data(a.features).enter().append("path").attr("fill",r).attr("stroke",o).attr("stroke-width",.5).attr("d",n)},highlight:function(t){return e.transition().duration(500).style("fill",function(e){return t.has(e.properties.name)?"rgb(212, 88, 88)":r}),e},reset:function(){e.transition().duration(300).style("fill",r).style("stroke",o)}}}(),u=function(){var e=void 0,n=void 0,o=void 0,a=void 0,u=void 0;return{init:function(i,c,l){n=c,u=l;var s=r.extent(i,function(t){return t.value.attendance});return e=r.scaleSqrt().domain(s).range([4,20]),o=t.append("g").attr("class","bubbles"),a=o.selectAll("circle").data(i,n).enter().append("circle").attr("r",function(t){return e(t.value.attendance)}).attr("cx",function(t){return t.value.x}).attr("cy",function(t){return t.value.y}),u&&u(a),a},render:function(t){var r=o.selectAll("circle").data(t,n);return r.exit().remove(),(a=r.enter().append("circle").merge(r).attr("cx",function(t){return t.value.x}).attr("cy",function(t){return t.value.y})).transition().duration(500).attr("r",function(t){return e(t.value.attendance)}),u&&u(a),a}}}();function i(t){var n=function(t){return r.nest().key(function(t){return t.date.getUTCFullYear()}).rollup(function(t){var n=r.sum(t,function(t){return t.attendance}),o=t.map(function(t){return e([+t.long,+t.lat])}),a=r.mean(o,function(t){return t[0]}),u=r.mean(o,function(t){return t[1]}),i=r.set();return t.forEach(function(t){i.add(t.team1),i.add(t.team2)}),{attendance:n,x:a,y:u,teams:i,home:t[0].home,year:t[0].year,teamNumber:i.size()}}).entries(t)}(t);u.init(n.sort(function(t,e){return e.value.attendance-t.value.attendance}),function(t){return t.key},function(t){t.on("mouseover",function(t){o.update(r.event.pageX,r.event.pageY,t);var e=n.filter(function(e){return new Date(e.key).getFullYear()===parseInt(t.key)});a.highlight(e[0].value.teams)}).on("mousemove",function(t){o.move(r.event.pageX,r.event.pageY)}).on("mouseout",function(t){o.off(),a.reset()})});var i=function(t,e,n){for(var r=[],o=t;o<=e;o+=n)1942!==o&&1946!==o&&r.push(o);return r}(1930,2015,4);r.select("#vis-box").append("ul").attr("class","button__list-row").selectAll("li").data(i).enter().append("li").attr("class","button").append("button").text(function(t){return t}).on("mouseover",function(t){var e=n.filter(function(e){return new Date(e.key).getFullYear()===t});a.highlight(e[0].value.teams),u.render(e)}).on("mouseout",function(){a.reset(),u.render(n).on("mouseover",function(t){o.update(r.event.pageX,r.event.pageY,t);var e=n.filter(function(e){return new Date(e.key).getFullYear()===parseInt(t.key)});a.highlight(e[0].value.teams)}).on("mousemove",function(t){o.move(r.event.pageX,r.event.pageY)}).on("mouseout",function(t){o.off(),a.reset()})})}r.json("../assets/world_cup/world_countries.json").then(function(t){!function(t){a.init(t);var e=r.timeParse("%d-%m-%Y (%H:%M h)");r.tsv("../assets/world_cup/world_cup_geo.tsv",function(t){var n=e(t.date);return t.attendance=+t.attendance,t.date=n,t}).then(function(t){i(t)})}(t)})}()},,function(t,e){}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vcHVibGljL3dvcmxkX2N1cC9zY3JpcHRzL21haW4uanMiXSwibmFtZXMiOlsid2VicGFja0pzb25wQ2FsbGJhY2siLCJkYXRhIiwibW9kdWxlSWQiLCJjaHVua0lkIiwiY2h1bmtJZHMiLCJtb3JlTW9kdWxlcyIsImV4ZWN1dGVNb2R1bGVzIiwiaSIsInJlc29sdmVzIiwibGVuZ3RoIiwiaW5zdGFsbGVkQ2h1bmtzIiwicHVzaCIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIm1vZHVsZXMiLCJwYXJlbnRKc29ucEZ1bmN0aW9uIiwic2hpZnQiLCJkZWZlcnJlZE1vZHVsZXMiLCJhcHBseSIsImNoZWNrRGVmZXJyZWRNb2R1bGVzIiwicmVzdWx0IiwiZGVmZXJyZWRNb2R1bGUiLCJmdWxmaWxsZWQiLCJqIiwiZGVwSWQiLCJzcGxpY2UiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwicyIsImluc3RhbGxlZE1vZHVsZXMiLCIwIiwiZXhwb3J0cyIsIm1vZHVsZSIsImwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicCIsImpzb25wQXJyYXkiLCJ3aW5kb3ciLCJvbGRKc29ucEZ1bmN0aW9uIiwic2xpY2UiLCJkMyIsInJlcXVpcmUiLCJzdmciLCJzZWxlY3QiLCJhcHBlbmQiLCJzdHlsZSIsImF0dHIiLCJ3aWR0aCIsImhlaWdodCIsInByb2plY3Rpb24iLCJnZW9NZXJjYXRvciIsInNjYWxlIiwidHJhbnNsYXRlIiwicGF0aCIsImdlb1BhdGgiLCJ0b29sdGlwIiwiZG9tIiwib2Zmc2V0X3giLCJvZmZzZXRfeSIsImNhbGN1bGF0ZVBvcyIsIngiLCJ5Iiwidmlld1BvcnRXaWR0aCIsImlubmVyV2lkdGgiLCJ2aWV3UG9ydEhlaWdodCIsImlubmVySGVpZ2h0IiwiZG9tV2lkdGgiLCJub2RlIiwib2Zmc2V0V2lkdGgiLCJkb21IZWlnaHQiLCJvZmZzZXRIZWlnaHQiLCJ1cGRhdGUiLCJ0cmFuc2l0aW9uIiwiZHVyYXRpb24iLCJlYXNlIiwiZWFzZUN1YmljT3V0IiwiaHRtbCIsImNvbmNhdCIsImhvbWUiLCJhdHRlbmRhbmNlIiwidGVhbU51bWJlciIsInBvcyIsIm9mZiIsIm9uIiwibW92ZSIsIm1hcCIsIl9tYXAiLCJ1bmRlZmluZWQiLCJmaWxsIiwic3Ryb2tlIiwiaW5pdCIsImdlb19kYXRhIiwic2VsZWN0QWxsIiwiZmVhdHVyZXMiLCJlbnRlciIsImhpZ2hsaWdodCIsInNldCIsImhhcyIsInByb3BlcnRpZXMiLCJyZXNldCIsInBvaW50IiwiX3JhZGl1cyIsIl9rZXlfZnVuYyIsIl9wYXJlbnQiLCJfcG9pbnQiLCJfZXZlbnRIYW5kbGVyIiwia2V5X2Z1bmMiLCJldmVudEhhbmRsZXIiLCJleHRlbnQiLCJzY2FsZVNxcnQiLCJkb21haW4iLCJyYW5nZSIsInJlbmRlciIsImV4aXQiLCJyZW1vdmUiLCJtZXJnZSIsInBsb3RfcG9pbnQiLCJuZXN0ZWQiLCJuZXN0IiwiZ2V0VVRDRnVsbFllYXIiLCJyb2xsdXAiLCJncm91cCIsInRvdGFsIiwic3VtIiwiY29vcmRzIiwiY2VudGVyX3giLCJtZWFuIiwiY2VudGVyX3kiLCJ0ZWFtIiwiZm9yRWFjaCIsImFkZCIsInRlYW1zIiwieWVhciIsInNpemUiLCJlbnRyaWVzIiwibmVzdGVkRGF0YSIsInNvcnQiLCJhIiwiYiIsInBvaW50cyIsImV2ZW50IiwicGFnZVgiLCJwYWdlWSIsImZpbHRlcmVkIiwiZmlsdGVyIiwiZDEiLCJEYXRlIiwiZ2V0RnVsbFllYXIiLCJwYXJzZUludCIsInllYXJzIiwic3RhcnQiLCJlbmQiLCJzdGVwIiwicG9wdWxhdGVfeWVhciIsInRleHQiLCJqc29uIiwidGhlbiIsImdlb19qc29uIiwiZm9ybWF0IiwidGltZVBhcnNlIiwidHN2IiwiZGF0ZSIsImRyYXciXSwibWFwcGluZ3MiOiJhQUNBLFNBQUFBLEVBQUFDLEdBUUEsSUFQQSxJQU1BQyxFQUFBQyxFQU5BQyxFQUFBSCxFQUFBLEdBQ0FJLEVBQUFKLEVBQUEsR0FDQUssRUFBQUwsRUFBQSxHQUlBTSxFQUFBLEVBQUFDLEtBQ1FELEVBQUFILEVBQUFLLE9BQW9CRixJQUM1QkosRUFBQUMsRUFBQUcsR0FDQUcsRUFBQVAsSUFDQUssRUFBQUcsS0FBQUQsRUFBQVAsR0FBQSxJQUVBTyxFQUFBUCxHQUFBLEVBRUEsSUFBQUQsS0FBQUcsRUFDQU8sT0FBQUMsVUFBQUMsZUFBQUMsS0FBQVYsRUFBQUgsS0FDQWMsRUFBQWQsR0FBQUcsRUFBQUgsSUFLQSxJQUZBZSxLQUFBaEIsR0FFQU8sRUFBQUMsUUFDQUQsRUFBQVUsT0FBQVYsR0FPQSxPQUhBVyxFQUFBUixLQUFBUyxNQUFBRCxFQUFBYixPQUdBZSxJQUVBLFNBQUFBLElBRUEsSUFEQSxJQUFBQyxFQUNBZixFQUFBLEVBQWlCQSxFQUFBWSxFQUFBVixPQUE0QkYsSUFBQSxDQUc3QyxJQUZBLElBQUFnQixFQUFBSixFQUFBWixHQUNBaUIsR0FBQSxFQUNBQyxFQUFBLEVBQWtCQSxFQUFBRixFQUFBZCxPQUEyQmdCLElBQUEsQ0FDN0MsSUFBQUMsRUFBQUgsRUFBQUUsR0FDQSxJQUFBZixFQUFBZ0IsS0FBQUYsR0FBQSxHQUVBQSxJQUNBTCxFQUFBUSxPQUFBcEIsSUFBQSxHQUNBZSxFQUFBTSxJQUFBQyxFQUFBTixFQUFBLEtBR0EsT0FBQUQsRUFJQSxJQUFBUSxLQUtBcEIsR0FDQXFCLEVBQUEsR0FHQVosS0FHQSxTQUFBUyxFQUFBMUIsR0FHQSxHQUFBNEIsRUFBQTVCLEdBQ0EsT0FBQTRCLEVBQUE1QixHQUFBOEIsUUFHQSxJQUFBQyxFQUFBSCxFQUFBNUIsSUFDQUssRUFBQUwsRUFDQWdDLEdBQUEsRUFDQUYsWUFVQSxPQU5BaEIsRUFBQWQsR0FBQWEsS0FBQWtCLEVBQUFELFFBQUFDLElBQUFELFFBQUFKLEdBR0FLLEVBQUFDLEdBQUEsRUFHQUQsRUFBQUQsUUFLQUosRUFBQU8sRUFBQW5CLEVBR0FZLEVBQUFRLEVBQUFOLEVBR0FGLEVBQUFTLEVBQUEsU0FBQUwsRUFBQU0sRUFBQUMsR0FDQVgsRUFBQVksRUFBQVIsRUFBQU0sSUFDQTFCLE9BQUE2QixlQUFBVCxFQUFBTSxHQUEwQ0ksWUFBQSxFQUFBQyxJQUFBSixLQUsxQ1gsRUFBQWdCLEVBQUEsU0FBQVosR0FDQSxvQkFBQWEsZUFBQUMsYUFDQWxDLE9BQUE2QixlQUFBVCxFQUFBYSxPQUFBQyxhQUF3REMsTUFBQSxXQUV4RG5DLE9BQUE2QixlQUFBVCxFQUFBLGNBQWlEZSxPQUFBLEtBUWpEbkIsRUFBQW9CLEVBQUEsU0FBQUQsRUFBQUUsR0FFQSxHQURBLEVBQUFBLElBQUFGLEVBQUFuQixFQUFBbUIsSUFDQSxFQUFBRSxFQUFBLE9BQUFGLEVBQ0EsS0FBQUUsR0FBQSxpQkFBQUYsUUFBQUcsV0FBQSxPQUFBSCxFQUNBLElBQUFJLEVBQUF2QyxPQUFBd0MsT0FBQSxNQUdBLEdBRkF4QixFQUFBZ0IsRUFBQU8sR0FDQXZDLE9BQUE2QixlQUFBVSxFQUFBLFdBQXlDVCxZQUFBLEVBQUFLLFVBQ3pDLEVBQUFFLEdBQUEsaUJBQUFGLEVBQUEsUUFBQU0sS0FBQU4sRUFBQW5CLEVBQUFTLEVBQUFjLEVBQUFFLEVBQUEsU0FBQUEsR0FBZ0gsT0FBQU4sRUFBQU0sSUFBcUJDLEtBQUEsS0FBQUQsSUFDckksT0FBQUYsR0FJQXZCLEVBQUEyQixFQUFBLFNBQUF0QixHQUNBLElBQUFNLEVBQUFOLEtBQUFpQixXQUNBLFdBQTJCLE9BQUFqQixFQUFBLFNBQzNCLFdBQWlDLE9BQUFBLEdBRWpDLE9BREFMLEVBQUFTLEVBQUFFLEVBQUEsSUFBQUEsR0FDQUEsR0FJQVgsRUFBQVksRUFBQSxTQUFBZ0IsRUFBQUMsR0FBc0QsT0FBQTdDLE9BQUFDLFVBQUFDLGVBQUFDLEtBQUF5QyxFQUFBQyxJQUd0RDdCLEVBQUE4QixFQUFBLEdBRUEsSUFBQUMsRUFBQUMsT0FBQSxhQUFBQSxPQUFBLGlCQUNBQyxFQUFBRixFQUFBaEQsS0FBQTJDLEtBQUFLLEdBQ0FBLEVBQUFoRCxLQUFBWCxFQUNBMkQsSUFBQUcsUUFDQSxRQUFBdkQsRUFBQSxFQUFnQkEsRUFBQW9ELEVBQUFsRCxPQUF1QkYsSUFBQVAsRUFBQTJELEVBQUFwRCxJQUN2QyxJQUFBVSxFQUFBNEMsRUFJQTFDLEVBQUFSLE1BQUEsTUFFQVUsMkRDckpBLElBQU0wQyxFQUFLQyxFQUFRLElBbUJuQixXQUNFLGFBQ0EsSUFJSUMsRUFBTUYsRUFBR0csT0FBTyxZQUFZQyxPQUFPLE9BQ3BDQyxNQUFNLGFBQWMsV0FDcEJBLE1BQU0sU0FBVSxrQkFDaEJDLEtBQUssUUFBU0MsTUFDZEQsS0FBSyxTQUFVRSxLQUNmSixPQUFPLEtBQ1BFLEtBQUssUUFBUyxPQUliRyxFQUFhVCxFQUFHVSxjQUFjQyxNQUFNLEtBQUtDLFdBQVdMLElBQVdDLE1BQy9ESyxFQUFPYixFQUFHYyxVQUFVTCxXQUFXQSxHQU8vQk0sRUFBVyxXQUNiLElBQUlDLEVBQU1oQixFQUFHRyxPQUFPLFlBQVlDLE9BQU8sT0FBT0UsS0FBSyxRQUFTLFdBQ3hEVyxFQUFXLEVBQ1hDLEVBQVcsRUFFZixTQUFTQyxFQUFhQyxFQUFHQyxHQUV2QixJQUFJQyxFQUFnQnpCLE9BQU8wQixXQUN6QkMsRUFBaUIzQixPQUFPNEIsWUFDeEJDLEVBQVdWLEVBQUlXLE9BQU9DLFlBQ3RCQyxFQUFZYixFQUFJVyxPQUFPRyxhQVl6QixPQVZJVixFQUFJTSxFQUFXSixFQUNqQkYsR0FBTU0sRUFBV1QsRUFFakJHLEdBQUtILEVBRUhJLEVBQUlRLEVBQVlMLEVBQ2xCSCxHQUFNUSxFQUFZWCxFQUVsQkcsR0FBS0gsR0FFQ0UsRUFBR0MsR0E0Q2IsT0FDRVUsT0ExQ0YsU0FBZ0JYLEVBQUdDLEVBQUduRixHQXNDcEI4RSxFQUFJWCxNQUFNLFVBQVcsU0FwQ3JCVyxFQUFJZ0IsYUFDREMsU0FBUyxLQUNUQyxLQUFLbEMsRUFBR21DLGNBQ1I5QixNQUFNLFVBQVcsSUFFcEJXLEVBQUlvQixLQUFKLFlBQUFDLE9BQ2NuRyxFQUFLOEMsTUFBTXNELEtBRHpCLGdEQUFBRCxPQUdpQm5HLEVBQUtvRCxJQUh0Qiw2Q0FBQStDLE9BSThCbkcsRUFBSzhDLE1BQU11RCxXQUp6Qyx3Q0FBQUYsT0FLeUJuRyxFQUFLOEMsTUFBTXdELFdBTHBDLDJCQVNBLElBQUlDLEVBQU10QixFQUFhQyxFQUFHQyxHQUMxQkwsRUFBSVgsTUFBTSxPQUFTb0MsRUFBSSxHQUFNLE1BQzFCcEMsTUFBTSxNQUFRb0MsRUFBSSxHQUFNLE9BeUIzQkMsSUFoQkYsV0FDRTFCLEVBQUlnQixhQUNEQyxTQUFTLEtBQ1RVLEdBQUcsTUFBTyxXQUNUM0IsRUFBSVgsTUFBTSxVQUFXLFVBRXRCNkIsS0FBS2xDLEVBQUdtQyxjQUNSOUIsTUFBTSxVQUFXLElBVXBCdUMsS0F2QkYsU0FBY3hCLEVBQUdDLEdBQ2YsSUFBSW9CLEVBQU10QixFQUFhQyxFQUFHQyxHQUMxQkwsRUFBSVgsTUFBTSxPQUFTb0MsRUFBSSxHQUFNLE1BQzFCcEMsTUFBTSxNQUFRb0MsRUFBSSxHQUFNLFFBakRoQixHQStFWEksRUFBTyxXQUNULElBQUlDLE9BQU9DLEVBQ1RDLEVBQU8sVUFDUEMsRUFBUyxVQWlDWCxPQUNFQyxLQWhDRixTQUFjQyxHQVNaLE9BUkFMLEVBQU81QyxFQUFJa0QsVUFBVSxRQUNsQmxILEtBQUtpSCxFQUFTRSxVQUNkQyxRQUNBbEQsT0FBTyxRQUNQRSxLQUFLLE9BQVEwQyxHQUNiMUMsS0FBSyxTQUFVMkMsR0FDZjNDLEtBQUssZUFBZ0IsSUFDckJBLEtBQUssSUFBS08sSUF5QmIwQyxVQXJCRixTQUFtQkMsR0FTakIsT0FSQVYsRUFBS2QsYUFDRkMsU0FBUyxLQUNUNUIsTUFBTSxPQUFRLFNBQVUvQixHQUN2QixPQUFJa0YsRUFBSUMsSUFBSW5GLEVBQUVvRixXQUFXbkYsTUFDaEIsbUJBRUZ5RSxJQUVKRixHQWFQYSxNQVZGLFdBQ0ViLEVBQUtkLGFBQ0ZDLFNBQVMsS0FDVDVCLE1BQU0sT0FBUTJDLEdBQ2QzQyxNQUFNLFNBQVU0QyxLQWpDWixHQTRDUFcsRUFBUyxXQUNYLElBQUlDLE9BQVVkLEVBQ1ZlLE9BQVlmLEVBQ1pnQixPQUFVaEIsRUFDVmlCLE9BQVNqQixFQUNUa0IsT0FBZ0JsQixFQTZDcEIsT0FDRUcsS0E1Q0YsU0FBY2hILEVBQU1nSSxFQUFVQyxHQUM1QkwsRUFBWUksRUFDWkQsRUFBZ0JFLEVBRWhCLElBQUlDLEVBQVNwRSxFQUFHb0UsT0FBT2xJLEVBQU0sU0FBVW9DLEdBQ3JDLE9BQU9BLEVBQUVVLE1BQUYsYUFnQlQsT0FkQTZFLEVBQVU3RCxFQUFHcUUsWUFBWUMsT0FBT0YsR0FBUUcsT0FBTyxFQUFHLEtBRWxEUixFQUFVN0QsRUFBSUUsT0FBTyxLQUNsQkUsS0FBSyxRQUFTLFdBRWpCMEQsRUFBU0QsRUFBUVgsVUFBVSxVQUN4QmxILEtBQUtBLEVBQU00SCxHQUNYUixRQUNBbEQsT0FBTyxVQUNQRSxLQUFLLElBQUssU0FBQWhDLEdBQUMsT0FBSXVGLEVBQVF2RixFQUFFVSxNQUFNdUQsY0FDL0JqQyxLQUFLLEtBQU0sU0FBQWhDLEdBQUMsT0FBSUEsRUFBRVUsTUFBTW9DLElBQ3hCZCxLQUFLLEtBQU0sU0FBQWhDLEdBQUMsT0FBSUEsRUFBRVUsTUFBTXFDLElBRTNCNEMsR0FBaUJBLEVBQWNELEdBQ3hCQSxHQXdCUFEsT0FyQkYsU0FBZ0J0SSxHQUNkLElBQUkwSCxFQUFRRyxFQUFRWCxVQUFVLFVBQVVsSCxLQUFLQSxFQUFNNEgsR0FlbkQsT0FiQUYsRUFBTWEsT0FBT0MsVUFFYlYsRUFBU0osRUFBTU4sUUFDWmxELE9BQU8sVUFDUHVFLE1BQU1mLEdBQ050RCxLQUFLLEtBQU0sU0FBQWhDLEdBQUMsT0FBSUEsRUFBRVUsTUFBTW9DLElBQ3hCZCxLQUFLLEtBQU0sU0FBQWhDLEdBQUMsT0FBSUEsRUFBRVUsTUFBTXFDLEtBR3BCVyxhQUNKQyxTQUFTLEtBQ1QzQixLQUFLLElBQUssU0FBQWhDLEdBQUMsT0FBSXVGLEVBQVF2RixFQUFFVSxNQUFNdUQsY0FDbEMwQixHQUFpQkEsRUFBY0QsR0FDeEJBLElBL0NFLEdBd0diLFNBQVNZLEVBQVcxSSxHQUVsQixJQUFJMkksRUE3Q04sU0FBb0IzSSxHQUVsQixPQUFPOEQsRUFBRzhFLE9BQ1B4RixJQUFJLFNBQVVoQixHQUNiLE9BQU9BLEVBQUMsS0FBU3lHLG1CQUVsQkMsT0FBTyxTQUFVQyxHQUNoQixJQUFJQyxFQUFRbEYsRUFBR21GLElBQUlGLEVBQU8sU0FBVTNHLEdBQ2xDLE9BQU9BLEVBQUMsYUFHTjhHLEVBQVNILEVBQU1wQyxJQUFJLFNBQVV2RSxHQUMvQixPQUFPbUMsSUFBYW5DLEVBQUMsTUFBV0EsRUFBQyxRQUcvQitHLEVBQVdyRixFQUFHc0YsS0FBS0YsRUFBUSxTQUFVOUcsR0FDdkMsT0FBT0EsRUFBRSxLQUVQaUgsRUFBV3ZGLEVBQUdzRixLQUFLRixFQUFRLFNBQVU5RyxHQUN2QyxPQUFPQSxFQUFFLEtBR1BrSCxFQUFPeEYsRUFBR3dELE1BTWQsT0FMQXlCLEVBQU1RLFFBQVEsU0FBVW5ILEdBQ3RCa0gsRUFBS0UsSUFBSXBILEVBQUMsT0FDVmtILEVBQUtFLElBQUlwSCxFQUFDLFVBSVZpRSxXQUFZMkMsRUFDWjlELEVBQUdpRSxFQUNIaEUsRUFBR2tFLEVBQ0hJLE1BQU9ILEVBQ1BsRCxLQUFNMkMsRUFBTSxHQUFHM0MsS0FDZnNELEtBQU1YLEVBQU0sR0FBR1csS0FDZnBELFdBQVlnRCxFQUFLSyxVQUdwQkMsUUFBUTVKLEdBT0U2SixDQUFXN0osR0FFeEIwSCxFQUFNVixLQUFLMkIsRUFBT21CLEtBQUssU0FBVUMsRUFBR0MsR0FDbEMsT0FBT0EsRUFBRWxILE1BQU11RCxXQUFhMEQsRUFBRWpILE1BQU11RCxhQUNsQyxTQUFVakUsR0FDWixPQUFPQSxFQUFDLEtBQ1AsU0FBVTZILEdBQ1hBLEVBQ0d4RCxHQUFHLFlBQWEsU0FBVXJFLEdBQ3pCeUMsRUFBUWdCLE9BQU8vQixFQUFHb0csTUFBTUMsTUFBT3JHLEVBQUdvRyxNQUFNRSxNQUFPaEksR0FDL0MsSUFBSWlJLEVBQVcxQixFQUFPMkIsT0FBTyxTQUFVQyxHQUNyQyxPQUFPLElBQUlDLEtBQUtELEVBQUUsS0FBU0UsZ0JBQWtCQyxTQUFTdEksRUFBRWdCLE9BRTFEdUQsRUFBSVUsVUFBVWdELEVBQVMsR0FBR3ZILE1BQVosU0FFZjJELEdBQUcsWUFBYSxTQUFVckUsR0FDekJ5QyxFQUFRNkIsS0FBSzVDLEVBQUdvRyxNQUFNQyxNQUFPckcsRUFBR29HLE1BQU1FLFNBRXZDM0QsR0FBRyxXQUFZLFNBQVVyRSxHQUN4QnlDLEVBQVEyQixNQUNSRyxFQUFJYyxZQUtWLElBQUlrRCxFQWpTUixTQUF1QkMsRUFBT0MsRUFBS0MsR0FFakMsSUFEQSxJQUFJSCxLQUNLakIsRUFBT2tCLEVBQU9sQixHQUFRbUIsRUFBS25CLEdBQVFvQixFQUM3QixPQUFUcEIsR0FBMEIsT0FBVEEsR0FHckJpQixFQUFNakssS0FBS2dKLEdBRWIsT0FBT2lCLEVBeVJPSSxDQUFjLEtBQU0sS0FBTSxHQUV0Q2pILEVBQUdHLE9BQU8sWUFDUEMsT0FBTyxNQUNQRSxLQUFLLFFBQVMsb0JBQ2Q4QyxVQUFVLE1BQ1ZsSCxLQUFLMkssR0FDTHZELFFBQ0FsRCxPQUFPLE1BQ1BFLEtBQUssUUFBUyxVQUNkRixPQUFPLFVBQ1A4RyxLQUFLLFNBQVU1SSxHQUNkLE9BQU9BLElBRVJxRSxHQUFHLFlBQWEsU0FBVXJFLEdBQ3pCLElBQUlpSSxFQUFXMUIsRUFBTzJCLE9BQU8sU0FBVUMsR0FDckMsT0FBTyxJQUFJQyxLQUFLRCxFQUFFLEtBQVNFLGdCQUFrQnJJLElBRy9DdUUsRUFBSVUsVUFBVWdELEVBQVMsR0FBR3ZILE1BQVosT0FDZDRFLEVBQU1ZLE9BQU8rQixLQUVkNUQsR0FBRyxXQUFZLFdBQ2RFLEVBQUljLFFBQ0pDLEVBQU1ZLE9BQU9LLEdBQ1ZsQyxHQUFHLFlBQWEsU0FBVXJFLEdBQ3pCeUMsRUFBUWdCLE9BQU8vQixFQUFHb0csTUFBTUMsTUFBT3JHLEVBQUdvRyxNQUFNRSxNQUFPaEksR0FDL0MsSUFBSWlJLEVBQVcxQixFQUFPMkIsT0FBTyxTQUFVQyxHQUNyQyxPQUFPLElBQUlDLEtBQUtELEVBQUUsS0FBU0UsZ0JBQWtCQyxTQUFTdEksRUFBRWdCLE9BRTFEdUQsRUFBSVUsVUFBVWdELEVBQVMsR0FBR3ZILE1BQVosU0FFZjJELEdBQUcsWUFBYSxTQUFVckUsR0FDekJ5QyxFQUFRNkIsS0FBSzVDLEVBQUdvRyxNQUFNQyxNQUFPckcsRUFBR29HLE1BQU1FLFNBRXZDM0QsR0FBRyxXQUFZLFNBQVVyRSxHQUN4QnlDLEVBQVEyQixNQUNSRyxFQUFJYyxZQW9CZDNELEVBQUdtSCxLQUFLLDRDQUE0Q0MsS0FBSyxTQUFBbEwsSUFmekQsU0FBY21MLEdBQ1p4RSxFQUFJSyxLQUFLbUUsR0FDVCxJQUFJQyxFQUFTdEgsRUFBR3VILFVBQVUsc0JBRTFCdkgsRUFBR3dILElBQUksd0NBQXlDLFNBQVVsSixHQUN4RCxJQUFJbUosRUFBT0gsRUFBT2hKLEVBQUMsTUFHbkIsT0FGQUEsRUFBQyxZQUFrQkEsRUFBQyxXQUNwQkEsRUFBQyxLQUFXbUosRUFDTG5KLElBQ044SSxLQUFLLFNBQUFsTCxHQUNOMEksRUFBVzFJLEtBTWJ3TCxDQUFLeEwsS0FoVlQiLCJmaWxlIjoic2NyaXB0cy9tYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG4gXHRmdW5jdGlvbiB3ZWJwYWNrSnNvbnBDYWxsYmFjayhkYXRhKSB7XG4gXHRcdHZhciBjaHVua0lkcyA9IGRhdGFbMF07XG4gXHRcdHZhciBtb3JlTW9kdWxlcyA9IGRhdGFbMV07XG4gXHRcdHZhciBleGVjdXRlTW9kdWxlcyA9IGRhdGFbMl07XG5cbiBcdFx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG4gXHRcdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuIFx0XHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwLCByZXNvbHZlcyA9IFtdO1xuIFx0XHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuIFx0XHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcbiBcdFx0XHRpZihpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcbiBcdFx0XHRcdHJlc29sdmVzLnB1c2goaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdWzBdKTtcbiBcdFx0XHR9XG4gXHRcdFx0aW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID0gMDtcbiBcdFx0fVxuIFx0XHRmb3IobW9kdWxlSWQgaW4gbW9yZU1vZHVsZXMpIHtcbiBcdFx0XHRpZihPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwobW9yZU1vZHVsZXMsIG1vZHVsZUlkKSkge1xuIFx0XHRcdFx0bW9kdWxlc1ttb2R1bGVJZF0gPSBtb3JlTW9kdWxlc1ttb2R1bGVJZF07XG4gXHRcdFx0fVxuIFx0XHR9XG4gXHRcdGlmKHBhcmVudEpzb25wRnVuY3Rpb24pIHBhcmVudEpzb25wRnVuY3Rpb24oZGF0YSk7XG5cbiBcdFx0d2hpbGUocmVzb2x2ZXMubGVuZ3RoKSB7XG4gXHRcdFx0cmVzb2x2ZXMuc2hpZnQoKSgpO1xuIFx0XHR9XG5cbiBcdFx0Ly8gYWRkIGVudHJ5IG1vZHVsZXMgZnJvbSBsb2FkZWQgY2h1bmsgdG8gZGVmZXJyZWQgbGlzdFxuIFx0XHRkZWZlcnJlZE1vZHVsZXMucHVzaC5hcHBseShkZWZlcnJlZE1vZHVsZXMsIGV4ZWN1dGVNb2R1bGVzIHx8IFtdKTtcblxuIFx0XHQvLyBydW4gZGVmZXJyZWQgbW9kdWxlcyB3aGVuIGFsbCBjaHVua3MgcmVhZHlcbiBcdFx0cmV0dXJuIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCk7XG4gXHR9O1xuIFx0ZnVuY3Rpb24gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKSB7XG4gXHRcdHZhciByZXN1bHQ7XG4gXHRcdGZvcih2YXIgaSA9IDA7IGkgPCBkZWZlcnJlZE1vZHVsZXMubGVuZ3RoOyBpKyspIHtcbiBcdFx0XHR2YXIgZGVmZXJyZWRNb2R1bGUgPSBkZWZlcnJlZE1vZHVsZXNbaV07XG4gXHRcdFx0dmFyIGZ1bGZpbGxlZCA9IHRydWU7XG4gXHRcdFx0Zm9yKHZhciBqID0gMTsgaiA8IGRlZmVycmVkTW9kdWxlLmxlbmd0aDsgaisrKSB7XG4gXHRcdFx0XHR2YXIgZGVwSWQgPSBkZWZlcnJlZE1vZHVsZVtqXTtcbiBcdFx0XHRcdGlmKGluc3RhbGxlZENodW5rc1tkZXBJZF0gIT09IDApIGZ1bGZpbGxlZCA9IGZhbHNlO1xuIFx0XHRcdH1cbiBcdFx0XHRpZihmdWxmaWxsZWQpIHtcbiBcdFx0XHRcdGRlZmVycmVkTW9kdWxlcy5zcGxpY2UoaS0tLCAxKTtcbiBcdFx0XHRcdHJlc3VsdCA9IF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gZGVmZXJyZWRNb2R1bGVbMF0pO1xuIFx0XHRcdH1cbiBcdFx0fVxuIFx0XHRyZXR1cm4gcmVzdWx0O1xuIFx0fVxuXG4gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBvYmplY3QgdG8gc3RvcmUgbG9hZGVkIGFuZCBsb2FkaW5nIGNodW5rc1xuIFx0Ly8gdW5kZWZpbmVkID0gY2h1bmsgbm90IGxvYWRlZCwgbnVsbCA9IGNodW5rIHByZWxvYWRlZC9wcmVmZXRjaGVkXG4gXHQvLyBQcm9taXNlID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxuIFx0dmFyIGluc3RhbGxlZENodW5rcyA9IHtcbiBcdFx0MDogMFxuIFx0fTtcblxuIFx0dmFyIGRlZmVycmVkTW9kdWxlcyA9IFtdO1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHR2YXIganNvbnBBcnJheSA9IHdpbmRvd1tcIndlYnBhY2tKc29ucFwiXSA9IHdpbmRvd1tcIndlYnBhY2tKc29ucFwiXSB8fCBbXTtcbiBcdHZhciBvbGRKc29ucEZ1bmN0aW9uID0ganNvbnBBcnJheS5wdXNoLmJpbmQoanNvbnBBcnJheSk7XG4gXHRqc29ucEFycmF5LnB1c2ggPSB3ZWJwYWNrSnNvbnBDYWxsYmFjaztcbiBcdGpzb25wQXJyYXkgPSBqc29ucEFycmF5LnNsaWNlKCk7XG4gXHRmb3IodmFyIGkgPSAwOyBpIDwganNvbnBBcnJheS5sZW5ndGg7IGkrKykgd2VicGFja0pzb25wQ2FsbGJhY2soanNvbnBBcnJheVtpXSk7XG4gXHR2YXIgcGFyZW50SnNvbnBGdW5jdGlvbiA9IG9sZEpzb25wRnVuY3Rpb247XG5cblxuIFx0Ly8gYWRkIGVudHJ5IG1vZHVsZSB0byBkZWZlcnJlZCBsaXN0XG4gXHRkZWZlcnJlZE1vZHVsZXMucHVzaChbMCwxXSk7XG4gXHQvLyBydW4gZGVmZXJyZWQgbW9kdWxlcyB3aGVuIHJlYWR5XG4gXHRyZXR1cm4gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKTtcbiIsIi8qZXNsaW50IG5vLXVuZGVmOiAyKi9cclxuY29uc3QgZDMgPSByZXF1aXJlKFwiZDNcIik7XHJcblxyXG4vKipcclxuICogQHBhcmFtIHN0YXJ0IHtOdW1iZXJ9XHJcbiAqIEBwYXJhbSBlbmQge051bWJlcn1cclxuICogQHBhcmFtIHN0ZXAge051bWJlcn1cclxuICogQHJldHVybnMge0FycmF5fVxyXG4gKi9cclxuZnVuY3Rpb24gcG9wdWxhdGVfeWVhcihzdGFydCwgZW5kLCBzdGVwKSB7XHJcbiAgbGV0IHllYXJzID0gW107XHJcbiAgZm9yIChsZXQgeWVhciA9IHN0YXJ0OyB5ZWFyIDw9IGVuZDsgeWVhciArPSBzdGVwKSB7XHJcbiAgICBpZiAoeWVhciA9PT0gMTk0MiB8fCB5ZWFyID09PSAxOTQ2KSB7XHJcbiAgICAgIGNvbnRpbnVlO1xyXG4gICAgfVxyXG4gICAgeWVhcnMucHVzaCh5ZWFyKTtcclxuICB9XHJcbiAgcmV0dXJuIHllYXJzO1xyXG59XHJcblxyXG4oZnVuY3Rpb24gKCkge1xyXG4gIFwidXNlIHN0cmljdFwiO1xyXG4gIGxldCBtYXJnaW4gPSAwLFxyXG4gICAgd2lkdGggPSAxMjAwIC0gbWFyZ2luLFxyXG4gICAgaGVpZ2h0ID0gNzUwIC0gbWFyZ2luO1xyXG5cclxuICBsZXQgc3ZnID0gZDMuc2VsZWN0KFwiI3Zpcy1ib3hcIikuYXBwZW5kKFwic3ZnXCIpXHJcbiAgICAuc3R5bGUoXCJiYWNrZ3JvdW5kXCIsIFwiI2E4YmNjN1wiKVxyXG4gICAgLnN0eWxlKFwiYm9yZGVyXCIsIFwiMXB4IHNvbGlkICMwMDBcIilcclxuICAgIC5hdHRyKFwid2lkdGhcIiwgd2lkdGggKyBtYXJnaW4pXHJcbiAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQgKyBtYXJnaW4pXHJcbiAgICAuYXBwZW5kKFwiZ1wiKVxyXG4gICAgLmF0dHIoXCJjbGFzc1wiLCBcIm1hcFwiKTtcclxuXHJcblxyXG4gIC8vIOeUqOadpeWwhue7j+e6rOW6pui9rOaNouS4uuWxj+W5leS4iueahOWDj+e0oOOAglxyXG4gIGxldCBwcm9qZWN0aW9uID0gZDMuZ2VvTWVyY2F0b3IoKS5zY2FsZSgxOTApLnRyYW5zbGF0ZShbd2lkdGggLyAyLCBoZWlnaHQgLyAyICsgMTAwXSk7XHJcbiAgbGV0IHBhdGggPSBkMy5nZW9QYXRoKCkucHJvamVjdGlvbihwcm9qZWN0aW9uKTtcclxuXHJcblxyXG4gIC8qKlxyXG4gICAqIFRvb2x0aXAgY29udHJvbGxlclxyXG4gICAqIEB0eXBlIHt7dXBkYXRlLCBvZmYsIG1vdmV9fVxyXG4gICAqL1xyXG4gIGxldCB0b29sdGlwID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGxldCBkb20gPSBkMy5zZWxlY3QoXCIjdmlzLWJveFwiKS5hcHBlbmQoXCJkaXZcIikuYXR0cihcImNsYXNzXCIsIFwidG9vbHRpcFwiKTtcclxuICAgIGxldCBvZmZzZXRfeCA9IDU7XHJcbiAgICBsZXQgb2Zmc2V0X3kgPSA1O1xyXG5cclxuICAgIGZ1bmN0aW9uIGNhbGN1bGF0ZVBvcyh4LCB5KSB7XHJcblxyXG4gICAgICBsZXQgdmlld1BvcnRXaWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoLFxyXG4gICAgICAgIHZpZXdQb3J0SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0LFxyXG4gICAgICAgIGRvbVdpZHRoID0gZG9tLm5vZGUoKS5vZmZzZXRXaWR0aCxcclxuICAgICAgICBkb21IZWlnaHQgPSBkb20ubm9kZSgpLm9mZnNldEhlaWdodDtcclxuXHJcbiAgICAgIGlmICh4ICsgZG9tV2lkdGggPiB2aWV3UG9ydFdpZHRoKSB7XHJcbiAgICAgICAgeCAtPSAoZG9tV2lkdGggKyBvZmZzZXRfeCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgeCArPSBvZmZzZXRfeDtcclxuICAgICAgfVxyXG4gICAgICBpZiAoeSArIGRvbUhlaWdodCA+IHZpZXdQb3J0SGVpZ2h0KSB7XHJcbiAgICAgICAgeSAtPSAoZG9tSGVpZ2h0ICsgb2Zmc2V0X3kpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHkgKz0gb2Zmc2V0X3k7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIFt4LCB5XTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiB1cGRhdGUoeCwgeSwgZGF0YSkge1xyXG4gICAgICBvbigpO1xyXG4gICAgICBkb20udHJhbnNpdGlvbigpXHJcbiAgICAgICAgLmR1cmF0aW9uKDUwMClcclxuICAgICAgICAuZWFzZShkMy5lYXNlQ3ViaWNPdXQpXHJcbiAgICAgICAgLnN0eWxlKFwib3BhY2l0eVwiLCAuNyk7XHJcblxyXG4gICAgICBkb20uaHRtbChcclxuICAgICAgICBgPGgyPkhvbWU6JHtkYXRhLnZhbHVlLmhvbWV9PC9oMj5cclxuICAgICAgICAgIDx1bD5cclxuICAgICAgICAgICAgPGxpPlllYXI6JHtkYXRhLmtleX08L2xpPlxyXG4gICAgICAgICAgICA8bGk+VG90YWwgQXR0ZW5kYW5jZTogJHtkYXRhLnZhbHVlLmF0dGVuZGFuY2V9PC9saT5cclxuICAgICAgICAgICAgPGxpPlRlYW0gTnVtYmVyOiAke2RhdGEudmFsdWUudGVhbU51bWJlcn08L2xpPlxyXG4gICAgICAgICAgPC91bD5gXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBsZXQgcG9zID0gY2FsY3VsYXRlUG9zKHgsIHkpO1xyXG4gICAgICBkb20uc3R5bGUoXCJsZWZ0XCIsIChwb3NbMF0pICsgXCJweFwiKVxyXG4gICAgICAgIC5zdHlsZShcInRvcFwiLCAocG9zWzFdKSArIFwicHhcIik7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gbW92ZSh4LCB5KSB7XHJcbiAgICAgIGxldCBwb3MgPSBjYWxjdWxhdGVQb3MoeCwgeSk7XHJcbiAgICAgIGRvbS5zdHlsZShcImxlZnRcIiwgKHBvc1swXSkgKyBcInB4XCIpXHJcbiAgICAgICAgLnN0eWxlKFwidG9wXCIsIChwb3NbMV0pICsgXCJweFwiKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBvZmYoKSB7XHJcbiAgICAgIGRvbS50cmFuc2l0aW9uKClcclxuICAgICAgICAuZHVyYXRpb24oMzAwKVxyXG4gICAgICAgIC5vbihcImVuZFwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICBkb20uc3R5bGUoXCJkaXNwbGF5XCIsIFwibm9uZVwiKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5lYXNlKGQzLmVhc2VDdWJpY091dClcclxuICAgICAgICAuc3R5bGUoXCJvcGFjaXR5XCIsIC4wKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBvbigpIHtcclxuICAgICAgZG9tLnN0eWxlKFwiZGlzcGxheVwiLCBcImJsb2NrXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIHVwZGF0ZSxcclxuICAgICAgb2ZmLFxyXG4gICAgICBtb3ZlXHJcbiAgICB9O1xyXG4gIH0oKSk7XHJcblxyXG5cclxuICAvKipcclxuICAgKiBNYXAgY29udHJvbGxlclxyXG4gICAqIENhbGwgaW5pdCB3aXRoIGdlb0pzb24gZGF0YSB0byBpbml0aWFsaXphdGlvbiB0aGUgbWFwLlxyXG4gICAqIEB0eXBlIHt7aW5pdCwgaGlnaGxpZ2h0fX1cclxuICAgKi9cclxuICBsZXQgbWFwID0gKGZ1bmN0aW9uICgpIHtcclxuICAgIGxldCBfbWFwID0gdW5kZWZpbmVkLFxyXG4gICAgICBmaWxsID0gXCIjZjNlM2Q0XCIsXHJcbiAgICAgIHN0cm9rZSA9IFwiI2E4YmNjN1wiO1xyXG5cclxuICAgIGZ1bmN0aW9uIGluaXQoZ2VvX2RhdGEpIHtcclxuICAgICAgX21hcCA9IHN2Zy5zZWxlY3RBbGwoXCJwYXRoXCIpXHJcbiAgICAgICAgLmRhdGEoZ2VvX2RhdGEuZmVhdHVyZXMpXHJcbiAgICAgICAgLmVudGVyKClcclxuICAgICAgICAuYXBwZW5kKFwicGF0aFwiKVxyXG4gICAgICAgIC5hdHRyKFwiZmlsbFwiLCBmaWxsKVxyXG4gICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIHN0cm9rZSlcclxuICAgICAgICAuYXR0cihcInN0cm9rZS13aWR0aFwiLCAwLjUpXHJcbiAgICAgICAgLmF0dHIoXCJkXCIsIHBhdGgpO1xyXG4gICAgICByZXR1cm4gX21hcDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBoaWdobGlnaHQoc2V0KSB7XHJcbiAgICAgIF9tYXAudHJhbnNpdGlvbigpXHJcbiAgICAgICAgLmR1cmF0aW9uKDUwMClcclxuICAgICAgICAuc3R5bGUoXCJmaWxsXCIsIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICBpZiAoc2V0LmhhcyhkLnByb3BlcnRpZXMubmFtZSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFwicmdiKDIxMiwgODgsIDg4KVwiO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcmV0dXJuIGZpbGw7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIHJldHVybiBfbWFwO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIHJlc2V0KCkge1xyXG4gICAgICBfbWFwLnRyYW5zaXRpb24oKVxyXG4gICAgICAgIC5kdXJhdGlvbigzMDApXHJcbiAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBmaWxsKVxyXG4gICAgICAgIC5zdHlsZShcInN0cm9rZVwiLCBzdHJva2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiB7XHJcbiAgICAgIGluaXQsXHJcbiAgICAgIGhpZ2hsaWdodCxcclxuICAgICAgcmVzZXRcclxuICAgIH07XHJcbiAgfSgpKTtcclxuXHJcblxyXG4gIGxldCBwb2ludCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgX3JhZGl1cyA9IHVuZGVmaW5lZDtcclxuICAgIGxldCBfa2V5X2Z1bmMgPSB1bmRlZmluZWQ7XHJcbiAgICBsZXQgX3BhcmVudCA9IHVuZGVmaW5lZDtcclxuICAgIGxldCBfcG9pbnQgPSB1bmRlZmluZWQ7XHJcbiAgICBsZXQgX2V2ZW50SGFuZGxlciA9IHVuZGVmaW5lZDtcclxuXHJcbiAgICBmdW5jdGlvbiBpbml0KGRhdGEsIGtleV9mdW5jLCBldmVudEhhbmRsZXIpIHtcclxuICAgICAgX2tleV9mdW5jID0ga2V5X2Z1bmM7XHJcbiAgICAgIF9ldmVudEhhbmRsZXIgPSBldmVudEhhbmRsZXI7XHJcbiAgICAgIC8vIEZpbmQgbWluIGFuZCBtYXhcclxuICAgICAgbGV0IGV4dGVudCA9IGQzLmV4dGVudChkYXRhLCBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgIHJldHVybiBkLnZhbHVlW1wiYXR0ZW5kYW5jZVwiXTtcclxuICAgICAgfSk7XHJcbiAgICAgIF9yYWRpdXMgPSBkMy5zY2FsZVNxcnQoKS5kb21haW4oZXh0ZW50KS5yYW5nZShbNCwgMjBdKTtcclxuXHJcbiAgICAgIF9wYXJlbnQgPSBzdmcuYXBwZW5kKFwiZ1wiKVxyXG4gICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJidWJibGVzXCIpO1xyXG5cclxuICAgICAgX3BvaW50ID0gX3BhcmVudC5zZWxlY3RBbGwoXCJjaXJjbGVcIilcclxuICAgICAgICAuZGF0YShkYXRhLCBfa2V5X2Z1bmMpXHJcbiAgICAgICAgLmVudGVyKClcclxuICAgICAgICAuYXBwZW5kKFwiY2lyY2xlXCIpXHJcbiAgICAgICAgLmF0dHIoXCJyXCIsIGQgPT4gX3JhZGl1cyhkLnZhbHVlLmF0dGVuZGFuY2UpKVxyXG4gICAgICAgIC5hdHRyKFwiY3hcIiwgZCA9PiBkLnZhbHVlLngpXHJcbiAgICAgICAgLmF0dHIoXCJjeVwiLCBkID0+IGQudmFsdWUueSk7XHJcblxyXG4gICAgICBfZXZlbnRIYW5kbGVyICYmIF9ldmVudEhhbmRsZXIoX3BvaW50KTtcclxuICAgICAgcmV0dXJuIF9wb2ludDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZW5kZXIoZGF0YSkge1xyXG4gICAgICBsZXQgcG9pbnQgPSBfcGFyZW50LnNlbGVjdEFsbChcImNpcmNsZVwiKS5kYXRhKGRhdGEsIF9rZXlfZnVuYyk7XHJcbiAgICAgIC8vIGRlYnVnZ2VyXHJcbiAgICAgIHBvaW50LmV4aXQoKS5yZW1vdmUoKTtcclxuXHJcbiAgICAgIF9wb2ludCA9IHBvaW50LmVudGVyKClcclxuICAgICAgICAuYXBwZW5kKFwiY2lyY2xlXCIpXHJcbiAgICAgICAgLm1lcmdlKHBvaW50KVxyXG4gICAgICAgIC5hdHRyKFwiY3hcIiwgZCA9PiBkLnZhbHVlLngpXHJcbiAgICAgICAgLmF0dHIoXCJjeVwiLCBkID0+IGQudmFsdWUueSlcclxuXHJcblxyXG4gICAgICBfcG9pbnQudHJhbnNpdGlvbigpXHJcbiAgICAgICAgLmR1cmF0aW9uKDUwMClcclxuICAgICAgICAuYXR0cihcInJcIiwgZCA9PiBfcmFkaXVzKGQudmFsdWUuYXR0ZW5kYW5jZSkpO1xyXG4gICAgICBfZXZlbnRIYW5kbGVyICYmIF9ldmVudEhhbmRsZXIoX3BvaW50KTtcclxuICAgICAgcmV0dXJuIF9wb2ludDtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpbml0LFxyXG4gICAgICByZW5kZXJcclxuICAgIH1cclxuICB9KCkpO1xyXG5cclxuICAvKipcclxuICAgKiBHZXQgbmVzdGVkIGRhdGFcclxuICAgKiBAcGFyYW0gZGF0YVxyXG4gICAqIEByZXR1cm5zIHsqfVxyXG4gICAqL1xyXG4gIGZ1bmN0aW9uIG5lc3RlZERhdGEoZGF0YSkge1xyXG4gICAgLy8g5pWw5o2u6IGa5ZCIXHJcbiAgICByZXR1cm4gZDMubmVzdCgpXHJcbiAgICAgIC5rZXkoZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICByZXR1cm4gZFtcImRhdGVcIl0uZ2V0VVRDRnVsbFllYXIoKTtcclxuICAgICAgfSlcclxuICAgICAgLnJvbGx1cChmdW5jdGlvbiAoZ3JvdXApIHtcclxuICAgICAgICBsZXQgdG90YWwgPSBkMy5zdW0oZ3JvdXAsIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICByZXR1cm4gZFtcImF0dGVuZGFuY2VcIl07XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBjb29yZHMgPSBncm91cC5tYXAoZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICAgIHJldHVybiBwcm9qZWN0aW9uKFsrZFtcImxvbmdcIl0sICtkW1wibGF0XCJdXSlcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IGNlbnRlcl94ID0gZDMubWVhbihjb29yZHMsIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICByZXR1cm4gZFswXTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBsZXQgY2VudGVyX3kgPSBkMy5tZWFuKGNvb3JkcywgZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICAgIHJldHVybiBkWzFdO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsZXQgdGVhbSA9IGQzLnNldCgpO1xyXG4gICAgICAgIGdyb3VwLmZvckVhY2goZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICAgIHRlYW0uYWRkKGRbXCJ0ZWFtMVwiXSk7XHJcbiAgICAgICAgICB0ZWFtLmFkZChkW1widGVhbTJcIl0pO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgYXR0ZW5kYW5jZTogdG90YWwsXHJcbiAgICAgICAgICB4OiBjZW50ZXJfeCxcclxuICAgICAgICAgIHk6IGNlbnRlcl95LFxyXG4gICAgICAgICAgdGVhbXM6IHRlYW0sXHJcbiAgICAgICAgICBob21lOiBncm91cFswXS5ob21lLFxyXG4gICAgICAgICAgeWVhcjogZ3JvdXBbMF0ueWVhcixcclxuICAgICAgICAgIHRlYW1OdW1iZXI6IHRlYW0uc2l6ZSgpXHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgICAuZW50cmllcyhkYXRhKTtcclxuICB9XHJcblxyXG5cclxuICAvLyDmoLnmja7kuJbnlYzmna/ljoblj7LmlbDmja7lnKjlnLDlm77kuIrmoIflh7rkvY3nva5cclxuICBmdW5jdGlvbiBwbG90X3BvaW50KGRhdGEpIHtcclxuICAgIC8vIFRoaXMgaXMgdGhlIG1haW4gZGF0YSB3ZSBuZWVkLlxyXG4gICAgbGV0IG5lc3RlZCA9IG5lc3RlZERhdGEoZGF0YSk7XHJcblxyXG4gICAgcG9pbnQuaW5pdChuZXN0ZWQuc29ydChmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgICByZXR1cm4gYi52YWx1ZS5hdHRlbmRhbmNlIC0gYS52YWx1ZS5hdHRlbmRhbmNlO1xyXG4gICAgfSksIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgIHJldHVybiBkW1wia2V5XCJdO1xyXG4gICAgfSwgZnVuY3Rpb24gKHBvaW50cykge1xyXG4gICAgICBwb2ludHNcclxuICAgICAgICAub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICAgIHRvb2x0aXAudXBkYXRlKGQzLmV2ZW50LnBhZ2VYLCBkMy5ldmVudC5wYWdlWSwgZCk7XHJcbiAgICAgICAgICBsZXQgZmlsdGVyZWQgPSBuZXN0ZWQuZmlsdGVyKGZ1bmN0aW9uIChkMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoZDFbXCJrZXlcIl0pLmdldEZ1bGxZZWFyKCkgPT09IHBhcnNlSW50KGQua2V5KTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgbWFwLmhpZ2hsaWdodChmaWx0ZXJlZFswXS52YWx1ZVtcInRlYW1zXCJdKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbihcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgdG9vbHRpcC5tb3ZlKGQzLmV2ZW50LnBhZ2VYLCBkMy5ldmVudC5wYWdlWSlcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICB0b29sdGlwLm9mZigpO1xyXG4gICAgICAgICAgbWFwLnJlc2V0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgbGV0IHllYXJzID0gcG9wdWxhdGVfeWVhcigxOTMwLCAyMDE1LCA0KTtcclxuXHJcbiAgICBkMy5zZWxlY3QoXCIjdmlzLWJveFwiKVxyXG4gICAgICAuYXBwZW5kKFwidWxcIilcclxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImJ1dHRvbl9fbGlzdC1yb3dcIilcclxuICAgICAgLnNlbGVjdEFsbChcImxpXCIpXHJcbiAgICAgIC5kYXRhKHllYXJzKVxyXG4gICAgICAuZW50ZXIoKVxyXG4gICAgICAuYXBwZW5kKFwibGlcIilcclxuICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImJ1dHRvblwiKVxyXG4gICAgICAuYXBwZW5kKFwiYnV0dG9uXCIpXHJcbiAgICAgIC50ZXh0KGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgcmV0dXJuIGQ7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5vbihcIm1vdXNlb3ZlclwiLCBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgIGxldCBmaWx0ZXJlZCA9IG5lc3RlZC5maWx0ZXIoZnVuY3Rpb24gKGQxKSB7XHJcbiAgICAgICAgICByZXR1cm4gbmV3IERhdGUoZDFbXCJrZXlcIl0pLmdldEZ1bGxZZWFyKCkgPT09IGQ7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIG1hcC5oaWdobGlnaHQoZmlsdGVyZWRbMF0udmFsdWVbXCJ0ZWFtc1wiXSk7XHJcbiAgICAgICAgcG9pbnQucmVuZGVyKGZpbHRlcmVkKTtcclxuICAgICAgfSlcclxuICAgICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIG1hcC5yZXNldCgpO1xyXG4gICAgICAgIHBvaW50LnJlbmRlcihuZXN0ZWQpXHJcbiAgICAgICAgICAub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICAgICAgdG9vbHRpcC51cGRhdGUoZDMuZXZlbnQucGFnZVgsIGQzLmV2ZW50LnBhZ2VZLCBkKTtcclxuICAgICAgICAgICAgbGV0IGZpbHRlcmVkID0gbmVzdGVkLmZpbHRlcihmdW5jdGlvbiAoZDEpIHtcclxuICAgICAgICAgICAgICByZXR1cm4gbmV3IERhdGUoZDFbXCJrZXlcIl0pLmdldEZ1bGxZZWFyKCkgPT09IHBhcnNlSW50KGQua2V5KTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIG1hcC5oaWdobGlnaHQoZmlsdGVyZWRbMF0udmFsdWVbXCJ0ZWFtc1wiXSk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLm9uKFwibW91c2Vtb3ZlXCIsIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICAgIHRvb2x0aXAubW92ZShkMy5ldmVudC5wYWdlWCwgZDMuZXZlbnQucGFnZVkpXHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLm9uKFwibW91c2VvdXRcIiwgZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICAgICAgdG9vbHRpcC5vZmYoKTtcclxuICAgICAgICAgICAgbWFwLnJlc2V0KCk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBkcmF3KGdlb19qc29uKSB7XHJcbiAgICBtYXAuaW5pdChnZW9fanNvbik7XHJcbiAgICBsZXQgZm9ybWF0ID0gZDMudGltZVBhcnNlKFwiJWQtJW0tJVkgKCVIOiVNIGgpXCIpO1xyXG5cclxuICAgIGQzLnRzdihcIi4uL2Fzc2V0cy93b3JsZF9jdXAvd29ybGRfY3VwX2dlby50c3ZcIiwgZnVuY3Rpb24gKGQpIHtcclxuICAgICAgbGV0IGRhdGUgPSBmb3JtYXQoZFtcImRhdGVcIl0pO1xyXG4gICAgICBkW1wiYXR0ZW5kYW5jZVwiXSA9ICtkW1wiYXR0ZW5kYW5jZVwiXTtcclxuICAgICAgZFtcImRhdGVcIl0gPSBkYXRlO1xyXG4gICAgICByZXR1cm4gZDtcclxuICAgIH0pLnRoZW4oZGF0YSA9PiB7XHJcbiAgICAgIHBsb3RfcG9pbnQoZGF0YSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIOiOt+WPlmdlb0pzb27lnLDlm77mlbDmja5cclxuICBkMy5qc29uKFwiLi4vYXNzZXRzL3dvcmxkX2N1cC93b3JsZF9jb3VudHJpZXMuanNvblwiKS50aGVuKGRhdGEgPT4ge1xyXG4gICAgZHJhdyhkYXRhKTtcclxuICB9KTtcclxufSkoKTtcclxuIl0sInNvdXJjZVJvb3QiOiIifQ==