!function(e){function t(t){for(var r,u,i=t[0],c=t[1],l=t[2],f=0,d=[];f<i.length;f++)u=i[f],a[u]&&d.push(a[u][0]),a[u]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(s&&s(t);d.length;)d.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],r=!0,i=1;i<n.length;i++){var c=n[i];0!==a[c]&&(r=!1)}r&&(o.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},a={3:0},o=[];function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var s=c;o.push([2,0,1]),n()}({2:function(e,t,n){"use strict";n.r(t);n(9);var r=n(0),a=n(3);console.log("World_cup: ",r.a),function(){var e=a.select("#vis-box").append("svg").style("background","#a8bcc7").style("border","1px solid #000").attr("width",1200).attr("height",750).append("g").attr("class","map"),t=a.geoMercator().scale(190).translate([600,475]),n=a.geoPath().projection(t),r=function(){var e=a.select("#vis-box").append("div").attr("class","tooltip"),t=5,n=5;function r(r,a){var o=window.innerWidth,u=window.innerHeight,i=e.node().offsetWidth,c=e.node().offsetHeight;return r+i>o?r-=i+t:r+=t,a+c>u?a-=c+n:a+=n,[r,a]}return{update:function(t,n,o){e.style("display","block"),e.transition().duration(500).ease(a.easeCubicOut).style("opacity",.7),e.html("<h2>Home:".concat(o.value.home,"</h2>\n          <ul>\n            <li>Year:").concat(o.key,"</li>\n            <li>Total Attendance: ").concat(o.value.attendance,"</li>\n            <li>Team Number: ").concat(o.value.teamNumber,"</li>\n          </ul>"));var u=r(t,n);e.style("left",u[0]+"px").style("top",u[1]+"px")},off:function(){e.transition().duration(300).on("end",function(){e.style("display","none")}).ease(a.easeCubicOut).style("opacity",0)},move:function(t,n){var a=r(t,n);e.style("left",a[0]+"px").style("top",a[1]+"px")}}}(),o=function(){var t=void 0,r="#f3e3d4",a="#a8bcc7";return{init:function(o){return t=e.selectAll("path").data(o.features).enter().append("path").attr("fill",r).attr("stroke",a).attr("stroke-width",.5).attr("d",n)},highlight:function(e){return t.transition().duration(500).style("fill",function(t){return e.has(t.properties.name)?"rgb(212, 88, 88)":r}),t},reset:function(){t.transition().duration(300).style("fill",r).style("stroke",a)}}}(),u=function(){var t=void 0,n=void 0,r=void 0,o=void 0,u=void 0;return{init:function(i,c,l){n=c,u=l;var s=a.extent(i,function(e){return e.value.attendance});return t=a.scaleSqrt().domain(s).range([4,20]),r=e.append("g").attr("class","bubbles"),o=r.selectAll("circle").data(i,n).enter().append("circle").attr("r",function(e){return t(e.value.attendance)}).attr("cx",function(e){return e.value.x}).attr("cy",function(e){return e.value.y}),u&&u(o),o},render:function(e){var a=r.selectAll("circle").data(e,n);return a.exit().remove(),(o=a.enter().append("circle").merge(a).attr("cx",function(e){return e.value.x}).attr("cy",function(e){return e.value.y})).transition().duration(500).attr("r",function(e){return t(e.value.attendance)}),u&&u(o),o}}}();function i(e){var n=function(e){return a.nest().key(function(e){return e.date.getUTCFullYear()}).rollup(function(e){var n=a.sum(e,function(e){return e.attendance}),r=e.map(function(e){return t([+e.long,+e.lat])}),o=a.mean(r,function(e){return e[0]}),u=a.mean(r,function(e){return e[1]}),i=a.set();return e.forEach(function(e){i.add(e.team1),i.add(e.team2)}),{attendance:n,x:o,y:u,teams:i,home:e[0].home,year:e[0].year,teamNumber:i.size()}}).entries(e)}(e);u.init(n.sort(function(e,t){return t.value.attendance-e.value.attendance}),function(e){return e.key},function(e){e.on("mouseover",function(e){r.update(a.event.pageX,a.event.pageY,e);var t=n.filter(function(t){return new Date(t.key).getFullYear()===parseInt(e.key)});o.highlight(t[0].value.teams)}).on("mousemove",function(e){r.move(a.event.pageX,a.event.pageY)}).on("mouseout",function(e){r.off(),o.reset()})});var i=function(e,t,n){for(var r=[],a=e;a<=t;a+=n)1942!==a&&1946!==a&&r.push(a);return r}(1930,2015,4);a.select("#vis-box").append("ul").attr("class","button__list-row").selectAll("li").data(i).enter().append("li").attr("class","button").append("button").text(function(e){return e}).on("mouseover",function(e){var t=n.filter(function(t){return new Date(t.key).getFullYear()===e});o.highlight(t[0].value.teams),u.render(t)}).on("mouseout",function(){o.reset(),u.render(n).on("mouseover",function(e){r.update(a.event.pageX,a.event.pageY,e);var t=n.filter(function(t){return new Date(t.key).getFullYear()===parseInt(e.key)});o.highlight(t[0].value.teams)}).on("mousemove",function(e){r.move(a.event.pageX,a.event.pageY)}).on("mouseout",function(e){r.off(),o.reset()})})}a.json("../assets/world_countries.json").then(function(e){!function(e){o.init(e);var t=a.timeParse("%d-%m-%Y (%H:%M h)");a.tsv("../assets/world_cup_geo.tsv",function(e){var n=t(e.date);return e.attendance=+e.attendance,e.date=n,e}).then(function(e){i(e)})}(e)})}()},9:function(e,t){}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vcHVibGljL3dvcmxkX2N1cC9zY3JpcHRzL21haW4uanMiXSwibmFtZXMiOlsid2VicGFja0pzb25wQ2FsbGJhY2siLCJkYXRhIiwibW9kdWxlSWQiLCJjaHVua0lkIiwiY2h1bmtJZHMiLCJtb3JlTW9kdWxlcyIsImV4ZWN1dGVNb2R1bGVzIiwiaSIsInJlc29sdmVzIiwibGVuZ3RoIiwiaW5zdGFsbGVkQ2h1bmtzIiwicHVzaCIsIk9iamVjdCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsIm1vZHVsZXMiLCJwYXJlbnRKc29ucEZ1bmN0aW9uIiwic2hpZnQiLCJkZWZlcnJlZE1vZHVsZXMiLCJhcHBseSIsImNoZWNrRGVmZXJyZWRNb2R1bGVzIiwicmVzdWx0IiwiZGVmZXJyZWRNb2R1bGUiLCJmdWxmaWxsZWQiLCJqIiwiZGVwSWQiLCJzcGxpY2UiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwicyIsImluc3RhbGxlZE1vZHVsZXMiLCIzIiwiZXhwb3J0cyIsIm1vZHVsZSIsImwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicCIsImpzb25wQXJyYXkiLCJ3aW5kb3ciLCJvbGRKc29ucEZ1bmN0aW9uIiwic2xpY2UiLCJfX3dlYnBhY2tfZXhwb3J0c19fIiwiX3NoYXJlZF9zY3JpcHRzX1VJX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8xX18iLCJkMyIsInJlcXVpcmUiLCJjb25zb2xlIiwibG9nIiwiZm9vIiwic3ZnIiwic2VsZWN0IiwiYXBwZW5kIiwic3R5bGUiLCJhdHRyIiwid2lkdGgiLCJoZWlnaHQiLCJwcm9qZWN0aW9uIiwiZ2VvTWVyY2F0b3IiLCJzY2FsZSIsInRyYW5zbGF0ZSIsInBhdGgiLCJnZW9QYXRoIiwidG9vbHRpcCIsImRvbSIsIm9mZnNldF94Iiwib2Zmc2V0X3kiLCJjYWxjdWxhdGVQb3MiLCJ4IiwieSIsInZpZXdQb3J0V2lkdGgiLCJpbm5lcldpZHRoIiwidmlld1BvcnRIZWlnaHQiLCJpbm5lckhlaWdodCIsImRvbVdpZHRoIiwibm9kZSIsIm9mZnNldFdpZHRoIiwiZG9tSGVpZ2h0Iiwib2Zmc2V0SGVpZ2h0IiwidXBkYXRlIiwidHJhbnNpdGlvbiIsImR1cmF0aW9uIiwiZWFzZSIsImVhc2VDdWJpY091dCIsImh0bWwiLCJjb25jYXQiLCJob21lIiwiYXR0ZW5kYW5jZSIsInRlYW1OdW1iZXIiLCJwb3MiLCJvZmYiLCJvbiIsIm1vdmUiLCJtYXAiLCJfbWFwIiwidW5kZWZpbmVkIiwiZmlsbCIsInN0cm9rZSIsImluaXQiLCJnZW9fZGF0YSIsInNlbGVjdEFsbCIsImZlYXR1cmVzIiwiZW50ZXIiLCJoaWdobGlnaHQiLCJzZXQiLCJoYXMiLCJwcm9wZXJ0aWVzIiwicmVzZXQiLCJwb2ludCIsIl9yYWRpdXMiLCJfa2V5X2Z1bmMiLCJfcGFyZW50IiwiX3BvaW50IiwiX2V2ZW50SGFuZGxlciIsImtleV9mdW5jIiwiZXZlbnRIYW5kbGVyIiwiZXh0ZW50Iiwic2NhbGVTcXJ0IiwiZG9tYWluIiwicmFuZ2UiLCJyZW5kZXIiLCJleGl0IiwicmVtb3ZlIiwibWVyZ2UiLCJwbG90X3BvaW50IiwibmVzdGVkIiwibmVzdCIsImdldFVUQ0Z1bGxZZWFyIiwicm9sbHVwIiwiZ3JvdXAiLCJ0b3RhbCIsInN1bSIsImNvb3JkcyIsImNlbnRlcl94IiwibWVhbiIsImNlbnRlcl95IiwidGVhbSIsImZvckVhY2giLCJhZGQiLCJ0ZWFtcyIsInllYXIiLCJzaXplIiwiZW50cmllcyIsIm5lc3RlZERhdGEiLCJzb3J0IiwiYSIsImIiLCJwb2ludHMiLCJldmVudCIsInBhZ2VYIiwicGFnZVkiLCJmaWx0ZXJlZCIsImZpbHRlciIsImQxIiwiRGF0ZSIsImdldEZ1bGxZZWFyIiwicGFyc2VJbnQiLCJ5ZWFycyIsInN0YXJ0IiwiZW5kIiwic3RlcCIsInBvcHVsYXRlX3llYXIiLCJ0ZXh0IiwianNvbiIsInRoZW4iLCJnZW9fanNvbiIsImZvcm1hdCIsInRpbWVQYXJzZSIsInRzdiIsImRhdGUiLCJkcmF3Il0sIm1hcHBpbmdzIjoiYUFDQSxTQUFBQSxFQUFBQyxHQVFBLElBUEEsSUFNQUMsRUFBQUMsRUFOQUMsRUFBQUgsRUFBQSxHQUNBSSxFQUFBSixFQUFBLEdBQ0FLLEVBQUFMLEVBQUEsR0FJQU0sRUFBQSxFQUFBQyxLQUNRRCxFQUFBSCxFQUFBSyxPQUFvQkYsSUFDNUJKLEVBQUFDLEVBQUFHLEdBQ0FHLEVBQUFQLElBQ0FLLEVBQUFHLEtBQUFELEVBQUFQLEdBQUEsSUFFQU8sRUFBQVAsR0FBQSxFQUVBLElBQUFELEtBQUFHLEVBQ0FPLE9BQUFDLFVBQUFDLGVBQUFDLEtBQUFWLEVBQUFILEtBQ0FjLEVBQUFkLEdBQUFHLEVBQUFILElBS0EsSUFGQWUsS0FBQWhCLEdBRUFPLEVBQUFDLFFBQ0FELEVBQUFVLE9BQUFWLEdBT0EsT0FIQVcsRUFBQVIsS0FBQVMsTUFBQUQsRUFBQWIsT0FHQWUsSUFFQSxTQUFBQSxJQUVBLElBREEsSUFBQUMsRUFDQWYsRUFBQSxFQUFpQkEsRUFBQVksRUFBQVYsT0FBNEJGLElBQUEsQ0FHN0MsSUFGQSxJQUFBZ0IsRUFBQUosRUFBQVosR0FDQWlCLEdBQUEsRUFDQUMsRUFBQSxFQUFrQkEsRUFBQUYsRUFBQWQsT0FBMkJnQixJQUFBLENBQzdDLElBQUFDLEVBQUFILEVBQUFFLEdBQ0EsSUFBQWYsRUFBQWdCLEtBQUFGLEdBQUEsR0FFQUEsSUFDQUwsRUFBQVEsT0FBQXBCLElBQUEsR0FDQWUsRUFBQU0sSUFBQUMsRUFBQU4sRUFBQSxLQUdBLE9BQUFELEVBSUEsSUFBQVEsS0FLQXBCLEdBQ0FxQixFQUFBLEdBR0FaLEtBR0EsU0FB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VSxVQUFVZ0QsRUFBUyxHQUFHNUgsTUFBWixPQUNkaUYsRUFBTVksT0FBTytCLEtBRWQ1RCxHQUFHLFdBQVksV0FDZEUsRUFBSWMsUUFDSkMsRUFBTVksT0FBT0ssR0FDVmxDLEdBQUcsWUFBYSxTQUFVMUUsR0FDekI4QyxFQUFRZ0IsT0FBT2xDLEVBQUd1RyxNQUFNQyxNQUFPeEcsRUFBR3VHLE1BQU1FLE1BQU9ySSxHQUMvQyxJQUFJc0ksRUFBVzFCLEVBQU8yQixPQUFPLFNBQVVDLEdBQ3JDLE9BQU8sSUFBSUMsS0FBS0QsRUFBRSxLQUFTRSxnQkFBa0JDLFNBQVMzSSxFQUFFZ0IsT0FFMUQ0RCxFQUFJVSxVQUFVZ0QsRUFBUyxHQUFHNUgsTUFBWixTQUVmZ0UsR0FBRyxZQUFhLFNBQVUxRSxHQUN6QjhDLEVBQVE2QixLQUFLL0MsRUFBR3VHLE1BQU1DLE1BQU94RyxFQUFHdUcsTUFBTUUsU0FFdkMzRCxHQUFHLFdBQVksU0FBVTFFLEdBQ3hCOEMsRUFBUTJCLE1BQ1JHLEVBQUljLFlBb0JkOUQsRUFBR3NILEtBQUssa0NBQWtDQyxLQUFLLFNBQUF2TCxJQWYvQyxTQUFjd0wsR0FDWnhFLEVBQUlLLEtBQUttRSxHQUNULElBQUlDLEVBQVN6SCxFQUFHMEgsVUFBVSxzQkFFMUIxSCxFQUFHMkgsSUFBSSw4QkFBK0IsU0FBVXZKLEdBQzlDLElBQUl3SixFQUFPSCxFQUFPckosRUFBQyxNQUduQixPQUZBQSxFQUFDLFlBQWtCQSxFQUFDLFdBQ3BCQSxFQUFDLEtBQVd3SixFQUNMeEosSUFDTm1KLEtBQUssU0FBQXZMLEdBQ04rSSxFQUFXL0ksS0FNYjZMLENBQUs3TCxLQWhWVCIsImZpbGUiOiJ3b3JsZF9jdXAvd29ybGRfY3VwLmU2ZDk5NzY1YmYuanMiLCJzb3VyY2VzQ29udGVudCI6WyIgXHQvLyBpbnN0YWxsIGEgSlNPTlAgY2FsbGJhY2sgZm9yIGNodW5rIGxvYWRpbmdcbiBcdGZ1bmN0aW9uIHdlYnBhY2tKc29ucENhbGxiYWNrKGRhdGEpIHtcbiBcdFx0dmFyIGNodW5rSWRzID0gZGF0YVswXTtcbiBcdFx0dmFyIG1vcmVNb2R1bGVzID0gZGF0YVsxXTtcbiBcdFx0dmFyIGV4ZWN1dGVNb2R1bGVzID0gZGF0YVsyXTtcblxuIFx0XHQvLyBhZGQgXCJtb3JlTW9kdWxlc1wiIHRvIHRoZSBtb2R1bGVzIG9iamVjdCxcbiBcdFx0Ly8gdGhlbiBmbGFnIGFsbCBcImNodW5rSWRzXCIgYXMgbG9hZGVkIGFuZCBmaXJlIGNhbGxiYWNrXG4gXHRcdHZhciBtb2R1bGVJZCwgY2h1bmtJZCwgaSA9IDAsIHJlc29sdmVzID0gW107XG4gXHRcdGZvcig7aSA8IGNodW5rSWRzLmxlbmd0aDsgaSsrKSB7XG4gXHRcdFx0Y2h1bmtJZCA9IGNodW5rSWRzW2ldO1xuIFx0XHRcdGlmKGluc3RhbGxlZENodW5rc1tjaHVua0lkXSkge1xuIFx0XHRcdFx0cmVzb2x2ZXMucHVzaChpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF1bMF0pO1xuIFx0XHRcdH1cbiBcdFx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuIFx0XHR9XG4gXHRcdGZvcihtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuIFx0XHRcdGlmKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtb3JlTW9kdWxlcywgbW9kdWxlSWQpKSB7XG4gXHRcdFx0XHRtb2R1bGVzW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcbiBcdFx0XHR9XG4gXHRcdH1cbiBcdFx0aWYocGFyZW50SnNvbnBGdW5jdGlvbikgcGFyZW50SnNvbnBGdW5jdGlvbihkYXRhKTtcblxuIFx0XHR3aGlsZShyZXNvbHZlcy5sZW5ndGgpIHtcbiBcdFx0XHRyZXNvbHZlcy5zaGlmdCgpKCk7XG4gXHRcdH1cblxuIFx0XHQvLyBhZGQgZW50cnkgbW9kdWxlcyBmcm9tIGxvYWRlZCBjaHVuayB0byBkZWZlcnJlZCBsaXN0XG4gXHRcdGRlZmVycmVkTW9kdWxlcy5wdXNoLmFwcGx5KGRlZmVycmVkTW9kdWxlcywgZXhlY3V0ZU1vZHVsZXMgfHwgW10pO1xuXG4gXHRcdC8vIHJ1biBkZWZlcnJlZCBtb2R1bGVzIHdoZW4gYWxsIGNodW5rcyByZWFkeVxuIFx0XHRyZXR1cm4gY2hlY2tEZWZlcnJlZE1vZHVsZXMoKTtcbiBcdH07XG4gXHRmdW5jdGlvbiBjaGVja0RlZmVycmVkTW9kdWxlcygpIHtcbiBcdFx0dmFyIHJlc3VsdDtcbiBcdFx0Zm9yKHZhciBpID0gMDsgaSA8IGRlZmVycmVkTW9kdWxlcy5sZW5ndGg7IGkrKykge1xuIFx0XHRcdHZhciBkZWZlcnJlZE1vZHVsZSA9IGRlZmVycmVkTW9kdWxlc1tpXTtcbiBcdFx0XHR2YXIgZnVsZmlsbGVkID0gdHJ1ZTtcbiBcdFx0XHRmb3IodmFyIGogPSAxOyBqIDwgZGVmZXJyZWRNb2R1bGUubGVuZ3RoOyBqKyspIHtcbiBcdFx0XHRcdHZhciBkZXBJZCA9IGRlZmVycmVkTW9kdWxlW2pdO1xuIFx0XHRcdFx0aWYoaW5zdGFsbGVkQ2h1bmtzW2RlcElkXSAhPT0gMCkgZnVsZmlsbGVkID0gZmFsc2U7XG4gXHRcdFx0fVxuIFx0XHRcdGlmKGZ1bGZpbGxlZCkge1xuIFx0XHRcdFx0ZGVmZXJyZWRNb2R1bGVzLnNwbGljZShpLS0sIDEpO1xuIFx0XHRcdFx0cmVzdWx0ID0gX193ZWJwYWNrX3JlcXVpcmVfXyhfX3dlYnBhY2tfcmVxdWlyZV9fLnMgPSBkZWZlcnJlZE1vZHVsZVswXSk7XG4gXHRcdFx0fVxuIFx0XHR9XG4gXHRcdHJldHVybiByZXN1bHQ7XG4gXHR9XG5cbiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4gXHQvLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbiBcdC8vIFByb21pc2UgPSBjaHVuayBsb2FkaW5nLCAwID0gY2h1bmsgbG9hZGVkXG4gXHR2YXIgaW5zdGFsbGVkQ2h1bmtzID0ge1xuIFx0XHQzOiAwXG4gXHR9O1xuXG4gXHR2YXIgZGVmZXJyZWRNb2R1bGVzID0gW107XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKSB7XG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4gXHRcdH1cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGk6IG1vZHVsZUlkLFxuIFx0XHRcdGw6IGZhbHNlLFxuIFx0XHRcdGV4cG9ydHM6IHt9XG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmwgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb24gZm9yIGhhcm1vbnkgZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4gXHRcdGlmKCFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywgbmFtZSkpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgbmFtZSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGdldHRlciB9KTtcbiBcdFx0fVxuIFx0fTtcblxuIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yID0gZnVuY3Rpb24oZXhwb3J0cykge1xuIFx0XHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcbiBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbiBcdFx0fVxuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xuIFx0fTtcblxuIFx0Ly8gY3JlYXRlIGEgZmFrZSBuYW1lc3BhY2Ugb2JqZWN0XG4gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbiBcdC8vIG1vZGUgJiAyOiBtZXJnZSBhbGwgcHJvcGVydGllcyBvZiB2YWx1ZSBpbnRvIHRoZSBuc1xuIFx0Ly8gbW9kZSAmIDQ6IHJldHVybiB2YWx1ZSB3aGVuIGFscmVhZHkgbnMgb2JqZWN0XG4gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnQgPSBmdW5jdGlvbih2YWx1ZSwgbW9kZSkge1xuIFx0XHRpZihtb2RlICYgMSkgdmFsdWUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKHZhbHVlKTtcbiBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbiBcdFx0aWYoKG1vZGUgJiA0KSAmJiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLl9fZXNNb2R1bGUpIHJldHVybiB2YWx1ZTtcbiBcdFx0dmFyIG5zID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KG5zLCAnZGVmYXVsdCcsIHsgZW51bWVyYWJsZTogdHJ1ZSwgdmFsdWU6IHZhbHVlIH0pO1xuIFx0XHRpZihtb2RlICYgMiAmJiB0eXBlb2YgdmFsdWUgIT0gJ3N0cmluZycpIGZvcih2YXIga2V5IGluIHZhbHVlKSBfX3dlYnBhY2tfcmVxdWlyZV9fLmQobnMsIGtleSwgZnVuY3Rpb24oa2V5KSB7IHJldHVybiB2YWx1ZVtrZXldOyB9LmJpbmQobnVsbCwga2V5KSk7XG4gXHRcdHJldHVybiBucztcbiBcdH07XG5cbiBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm4gPSBmdW5jdGlvbihtb2R1bGUpIHtcbiBcdFx0dmFyIGdldHRlciA9IG1vZHVsZSAmJiBtb2R1bGUuX19lc01vZHVsZSA/XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbiBcdFx0XHRmdW5jdGlvbiBnZXRNb2R1bGVFeHBvcnRzKCkgeyByZXR1cm4gbW9kdWxlOyB9O1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQoZ2V0dGVyLCAnYScsIGdldHRlcik7XG4gXHRcdHJldHVybiBnZXR0ZXI7XG4gXHR9O1xuXG4gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubyA9IGZ1bmN0aW9uKG9iamVjdCwgcHJvcGVydHkpIHsgcmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmplY3QsIHByb3BlcnR5KTsgfTtcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdHZhciBqc29ucEFycmF5ID0gd2luZG93W1wid2VicGFja0pzb25wXCJdID0gd2luZG93W1wid2VicGFja0pzb25wXCJdIHx8IFtdO1xuIFx0dmFyIG9sZEpzb25wRnVuY3Rpb24gPSBqc29ucEFycmF5LnB1c2guYmluZChqc29ucEFycmF5KTtcbiBcdGpzb25wQXJyYXkucHVzaCA9IHdlYnBhY2tKc29ucENhbGxiYWNrO1xuIFx0anNvbnBBcnJheSA9IGpzb25wQXJyYXkuc2xpY2UoKTtcbiBcdGZvcih2YXIgaSA9IDA7IGkgPCBqc29ucEFycmF5Lmxlbmd0aDsgaSsrKSB3ZWJwYWNrSnNvbnBDYWxsYmFjayhqc29ucEFycmF5W2ldKTtcbiBcdHZhciBwYXJlbnRKc29ucEZ1bmN0aW9uID0gb2xkSnNvbnBGdW5jdGlvbjtcblxuXG4gXHQvLyBhZGQgZW50cnkgbW9kdWxlIHRvIGRlZmVycmVkIGxpc3RcbiBcdGRlZmVycmVkTW9kdWxlcy5wdXNoKFsyLDAsMV0pO1xuIFx0Ly8gcnVuIGRlZmVycmVkIG1vZHVsZXMgd2hlbiByZWFkeVxuIFx0cmV0dXJuIGNoZWNrRGVmZXJyZWRNb2R1bGVzKCk7XG4iLCIvKmVzbGludCBuby11bmRlZjogMiovXHJcbmNvbnN0IGQzID0gcmVxdWlyZShcImQzXCIpO1xyXG5pbXBvcnQgXCIuLi9zdHlsZXNoZWV0cy9zdHlsZS5zY3NzXCI7XHJcbmltcG9ydCB7Zm9vfSBmcm9tIFwiLi4vLi4vc2hhcmVkL3NjcmlwdHMvVUlcIjtcclxuY29uc29sZS5sb2coXCJXb3JsZF9jdXA6IFwiLCBmb28pXHJcblxyXG4vKipcclxuICogQHBhcmFtIHN0YXJ0IHtOdW1iZXJ9XHJcbiAqIEBwYXJhbSBlbmQge051bWJlcn1cclxuICogQHBhcmFtIHN0ZXAge051bWJlcn1cclxuICogQHJldHVybnMge0FycmF5fVxyXG4gKi9cclxuZnVuY3Rpb24gcG9wdWxhdGVfeWVhcihzdGFydCwgZW5kLCBzdGVwKSB7XHJcbiAgbGV0IHllYXJzID0gW107XHJcbiAgZm9yIChsZXQgeWVhciA9IHN0YXJ0OyB5ZWFyIDw9IGVuZDsgeWVhciArPSBzdGVwKSB7XHJcbiAgICBpZiAoeWVhciA9PT0gMTk0MiB8fCB5ZWFyID09PSAxOTQ2KSB7XHJcbiAgICAgIGNvbnRpbnVlO1xyXG4gICAgfVxyXG4gICAgeWVhcnMucHVzaCh5ZWFyKTtcclxuICB9XHJcbiAgcmV0dXJuIHllYXJzO1xyXG59XHJcblxyXG5cclxuKGZ1bmN0aW9uICgpIHtcclxuICBcInVzZSBzdHJpY3RcIjtcclxuICBsZXQgbWFyZ2luID0gMCxcclxuICAgIHdpZHRoID0gMTIwMCAtIG1hcmdpbixcclxuICAgIGhlaWdodCA9IDc1MCAtIG1hcmdpbjtcclxuXHJcbiAgbGV0IHN2ZyA9IGQzLnNlbGVjdChcIiN2aXMtYm94XCIpLmFwcGVuZChcInN2Z1wiKVxyXG4gICAgLnN0eWxlKFwiYmFja2dyb3VuZFwiLCBcIiNhOGJjYzdcIilcclxuICAgIC5zdHlsZShcImJvcmRlclwiLCBcIjFweCBzb2xpZCAjMDAwXCIpXHJcbiAgICAuYXR0cihcIndpZHRoXCIsIHdpZHRoICsgbWFyZ2luKVxyXG4gICAgLmF0dHIoXCJoZWlnaHRcIiwgaGVpZ2h0ICsgbWFyZ2luKVxyXG4gICAgLmFwcGVuZChcImdcIilcclxuICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJtYXBcIik7XHJcblxyXG5cclxuICAvLyDnlKjmnaXlsIbnu4/nuqzluqbovazmjaLkuLrlsY/luZXkuIrnmoTlg4/ntKDjgIJcclxuICBsZXQgcHJvamVjdGlvbiA9IGQzLmdlb01lcmNhdG9yKCkuc2NhbGUoMTkwKS50cmFuc2xhdGUoW3dpZHRoIC8gMiwgaGVpZ2h0IC8gMiArIDEwMF0pO1xyXG4gIGxldCBwYXRoID0gZDMuZ2VvUGF0aCgpLnByb2plY3Rpb24ocHJvamVjdGlvbik7XHJcblxyXG5cclxuICAvKipcclxuICAgKiBUb29sdGlwIGNvbnRyb2xsZXJcclxuICAgKiBAdHlwZSB7e3VwZGF0ZSwgb2ZmLCBtb3ZlfX1cclxuICAgKi9cclxuICBsZXQgdG9vbHRpcCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgZG9tID0gZDMuc2VsZWN0KFwiI3Zpcy1ib3hcIikuYXBwZW5kKFwiZGl2XCIpLmF0dHIoXCJjbGFzc1wiLCBcInRvb2x0aXBcIik7XHJcbiAgICBsZXQgb2Zmc2V0X3ggPSA1O1xyXG4gICAgbGV0IG9mZnNldF95ID0gNTtcclxuXHJcbiAgICBmdW5jdGlvbiBjYWxjdWxhdGVQb3MoeCwgeSkge1xyXG5cclxuICAgICAgbGV0IHZpZXdQb3J0V2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aCxcclxuICAgICAgICB2aWV3UG9ydEhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCxcclxuICAgICAgICBkb21XaWR0aCA9IGRvbS5ub2RlKCkub2Zmc2V0V2lkdGgsXHJcbiAgICAgICAgZG9tSGVpZ2h0ID0gZG9tLm5vZGUoKS5vZmZzZXRIZWlnaHQ7XHJcblxyXG4gICAgICBpZiAoeCArIGRvbVdpZHRoID4gdmlld1BvcnRXaWR0aCkge1xyXG4gICAgICAgIHggLT0gKGRvbVdpZHRoICsgb2Zmc2V0X3gpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHggKz0gb2Zmc2V0X3g7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHkgKyBkb21IZWlnaHQgPiB2aWV3UG9ydEhlaWdodCkge1xyXG4gICAgICAgIHkgLT0gKGRvbUhlaWdodCArIG9mZnNldF95KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB5ICs9IG9mZnNldF95O1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBbeCwgeV07XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gdXBkYXRlKHgsIHksIGRhdGEpIHtcclxuICAgICAgb24oKTtcclxuICAgICAgZG9tLnRyYW5zaXRpb24oKVxyXG4gICAgICAgIC5kdXJhdGlvbig1MDApXHJcbiAgICAgICAgLmVhc2UoZDMuZWFzZUN1YmljT3V0KVxyXG4gICAgICAgIC5zdHlsZShcIm9wYWNpdHlcIiwgLjcpO1xyXG5cclxuICAgICAgZG9tLmh0bWwoXHJcbiAgICAgICAgYDxoMj5Ib21lOiR7ZGF0YS52YWx1ZS5ob21lfTwvaDI+XHJcbiAgICAgICAgICA8dWw+XHJcbiAgICAgICAgICAgIDxsaT5ZZWFyOiR7ZGF0YS5rZXl9PC9saT5cclxuICAgICAgICAgICAgPGxpPlRvdGFsIEF0dGVuZGFuY2U6ICR7ZGF0YS52YWx1ZS5hdHRlbmRhbmNlfTwvbGk+XHJcbiAgICAgICAgICAgIDxsaT5UZWFtIE51bWJlcjogJHtkYXRhLnZhbHVlLnRlYW1OdW1iZXJ9PC9saT5cclxuICAgICAgICAgIDwvdWw+YFxyXG4gICAgICApO1xyXG5cclxuICAgICAgbGV0IHBvcyA9IGNhbGN1bGF0ZVBvcyh4LCB5KTtcclxuICAgICAgZG9tLnN0eWxlKFwibGVmdFwiLCAocG9zWzBdKSArIFwicHhcIilcclxuICAgICAgICAuc3R5bGUoXCJ0b3BcIiwgKHBvc1sxXSkgKyBcInB4XCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIG1vdmUoeCwgeSkge1xyXG4gICAgICBsZXQgcG9zID0gY2FsY3VsYXRlUG9zKHgsIHkpO1xyXG4gICAgICBkb20uc3R5bGUoXCJsZWZ0XCIsIChwb3NbMF0pICsgXCJweFwiKVxyXG4gICAgICAgIC5zdHlsZShcInRvcFwiLCAocG9zWzFdKSArIFwicHhcIik7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gb2ZmKCkge1xyXG4gICAgICBkb20udHJhbnNpdGlvbigpXHJcbiAgICAgICAgLmR1cmF0aW9uKDMwMClcclxuICAgICAgICAub24oXCJlbmRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgZG9tLnN0eWxlKFwiZGlzcGxheVwiLCBcIm5vbmVcIik7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuZWFzZShkMy5lYXNlQ3ViaWNPdXQpXHJcbiAgICAgICAgLnN0eWxlKFwib3BhY2l0eVwiLCAuMCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gb24oKSB7XHJcbiAgICAgIGRvbS5zdHlsZShcImRpc3BsYXlcIiwgXCJibG9ja1wiKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB1cGRhdGUsXHJcbiAgICAgIG9mZixcclxuICAgICAgbW92ZVxyXG4gICAgfTtcclxuICB9KCkpO1xyXG5cclxuXHJcbiAgLyoqXHJcbiAgICogTWFwIGNvbnRyb2xsZXJcclxuICAgKiBDYWxsIGluaXQgd2l0aCBnZW9Kc29uIGRhdGEgdG8gaW5pdGlhbGl6YXRpb24gdGhlIG1hcC5cclxuICAgKiBAdHlwZSB7e2luaXQsIGhpZ2hsaWdodH19XHJcbiAgICovXHJcbiAgbGV0IG1hcCA9IChmdW5jdGlvbiAoKSB7XHJcbiAgICBsZXQgX21hcCA9IHVuZGVmaW5lZCxcclxuICAgICAgZmlsbCA9IFwiI2YzZTNkNFwiLFxyXG4gICAgICBzdHJva2UgPSBcIiNhOGJjYzdcIjtcclxuXHJcbiAgICBmdW5jdGlvbiBpbml0KGdlb19kYXRhKSB7XHJcbiAgICAgIF9tYXAgPSBzdmcuc2VsZWN0QWxsKFwicGF0aFwiKVxyXG4gICAgICAgIC5kYXRhKGdlb19kYXRhLmZlYXR1cmVzKVxyXG4gICAgICAgIC5lbnRlcigpXHJcbiAgICAgICAgLmFwcGVuZChcInBhdGhcIilcclxuICAgICAgICAuYXR0cihcImZpbGxcIiwgZmlsbClcclxuICAgICAgICAuYXR0cihcInN0cm9rZVwiLCBzdHJva2UpXHJcbiAgICAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgMC41KVxyXG4gICAgICAgIC5hdHRyKFwiZFwiLCBwYXRoKTtcclxuICAgICAgcmV0dXJuIF9tYXA7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaGlnaGxpZ2h0KHNldCkge1xyXG4gICAgICBfbWFwLnRyYW5zaXRpb24oKVxyXG4gICAgICAgIC5kdXJhdGlvbig1MDApXHJcbiAgICAgICAgLnN0eWxlKFwiZmlsbFwiLCBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgaWYgKHNldC5oYXMoZC5wcm9wZXJ0aWVzLm5hbWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBcInJnYigyMTIsIDg4LCA4OClcIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiBmaWxsO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gX21hcDtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiByZXNldCgpIHtcclxuICAgICAgX21hcC50cmFuc2l0aW9uKClcclxuICAgICAgICAuZHVyYXRpb24oMzAwKVxyXG4gICAgICAgIC5zdHlsZShcImZpbGxcIiwgZmlsbClcclxuICAgICAgICAuc3R5bGUoXCJzdHJva2VcIiwgc3Ryb2tlKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBpbml0LFxyXG4gICAgICBoaWdobGlnaHQsXHJcbiAgICAgIHJlc2V0XHJcbiAgICB9O1xyXG4gIH0oKSk7XHJcblxyXG5cclxuICBsZXQgcG9pbnQgPSAoZnVuY3Rpb24gKCkge1xyXG4gICAgbGV0IF9yYWRpdXMgPSB1bmRlZmluZWQ7XHJcbiAgICBsZXQgX2tleV9mdW5jID0gdW5kZWZpbmVkO1xyXG4gICAgbGV0IF9wYXJlbnQgPSB1bmRlZmluZWQ7XHJcbiAgICBsZXQgX3BvaW50ID0gdW5kZWZpbmVkO1xyXG4gICAgbGV0IF9ldmVudEhhbmRsZXIgPSB1bmRlZmluZWQ7XHJcblxyXG4gICAgZnVuY3Rpb24gaW5pdChkYXRhLCBrZXlfZnVuYywgZXZlbnRIYW5kbGVyKSB7XHJcbiAgICAgIF9rZXlfZnVuYyA9IGtleV9mdW5jO1xyXG4gICAgICBfZXZlbnRIYW5kbGVyID0gZXZlbnRIYW5kbGVyO1xyXG4gICAgICAvLyBGaW5kIG1pbiBhbmQgbWF4XHJcbiAgICAgIGxldCBleHRlbnQgPSBkMy5leHRlbnQoZGF0YSwgZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICByZXR1cm4gZC52YWx1ZVtcImF0dGVuZGFuY2VcIl07XHJcbiAgICAgIH0pO1xyXG4gICAgICBfcmFkaXVzID0gZDMuc2NhbGVTcXJ0KCkuZG9tYWluKGV4dGVudCkucmFuZ2UoWzQsIDIwXSk7XHJcblxyXG4gICAgICBfcGFyZW50ID0gc3ZnLmFwcGVuZChcImdcIilcclxuICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiYnViYmxlc1wiKTtcclxuXHJcbiAgICAgIF9wb2ludCA9IF9wYXJlbnQuc2VsZWN0QWxsKFwiY2lyY2xlXCIpXHJcbiAgICAgICAgLmRhdGEoZGF0YSwgX2tleV9mdW5jKVxyXG4gICAgICAgIC5lbnRlcigpXHJcbiAgICAgICAgLmFwcGVuZChcImNpcmNsZVwiKVxyXG4gICAgICAgIC5hdHRyKFwiclwiLCBkID0+IF9yYWRpdXMoZC52YWx1ZS5hdHRlbmRhbmNlKSlcclxuICAgICAgICAuYXR0cihcImN4XCIsIGQgPT4gZC52YWx1ZS54KVxyXG4gICAgICAgIC5hdHRyKFwiY3lcIiwgZCA9PiBkLnZhbHVlLnkpO1xyXG5cclxuICAgICAgX2V2ZW50SGFuZGxlciAmJiBfZXZlbnRIYW5kbGVyKF9wb2ludCk7XHJcbiAgICAgIHJldHVybiBfcG9pbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gcmVuZGVyKGRhdGEpIHtcclxuICAgICAgbGV0IHBvaW50ID0gX3BhcmVudC5zZWxlY3RBbGwoXCJjaXJjbGVcIikuZGF0YShkYXRhLCBfa2V5X2Z1bmMpO1xyXG4gICAgICAvLyBkZWJ1Z2dlclxyXG4gICAgICBwb2ludC5leGl0KCkucmVtb3ZlKCk7XHJcblxyXG4gICAgICBfcG9pbnQgPSBwb2ludC5lbnRlcigpXHJcbiAgICAgICAgLmFwcGVuZChcImNpcmNsZVwiKVxyXG4gICAgICAgIC5tZXJnZShwb2ludClcclxuICAgICAgICAuYXR0cihcImN4XCIsIGQgPT4gZC52YWx1ZS54KVxyXG4gICAgICAgIC5hdHRyKFwiY3lcIiwgZCA9PiBkLnZhbHVlLnkpXHJcblxyXG5cclxuICAgICAgX3BvaW50LnRyYW5zaXRpb24oKVxyXG4gICAgICAgIC5kdXJhdGlvbig1MDApXHJcbiAgICAgICAgLmF0dHIoXCJyXCIsIGQgPT4gX3JhZGl1cyhkLnZhbHVlLmF0dGVuZGFuY2UpKTtcclxuICAgICAgX2V2ZW50SGFuZGxlciAmJiBfZXZlbnRIYW5kbGVyKF9wb2ludCk7XHJcbiAgICAgIHJldHVybiBfcG9pbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgaW5pdCxcclxuICAgICAgcmVuZGVyXHJcbiAgICB9XHJcbiAgfSgpKTtcclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IG5lc3RlZCBkYXRhXHJcbiAgICogQHBhcmFtIGRhdGFcclxuICAgKiBAcmV0dXJucyB7Kn1cclxuICAgKi9cclxuICBmdW5jdGlvbiBuZXN0ZWREYXRhKGRhdGEpIHtcclxuICAgIC8vIOaVsOaNruiBmuWQiFxyXG4gICAgcmV0dXJuIGQzLm5lc3QoKVxyXG4gICAgICAua2V5KGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgcmV0dXJuIGRbXCJkYXRlXCJdLmdldFVUQ0Z1bGxZZWFyKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5yb2xsdXAoZnVuY3Rpb24gKGdyb3VwKSB7XHJcbiAgICAgICAgbGV0IHRvdGFsID0gZDMuc3VtKGdyb3VwLCBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgcmV0dXJuIGRbXCJhdHRlbmRhbmNlXCJdO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBsZXQgY29vcmRzID0gZ3JvdXAubWFwKGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICByZXR1cm4gcHJvamVjdGlvbihbK2RbXCJsb25nXCJdLCArZFtcImxhdFwiXV0pXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGxldCBjZW50ZXJfeCA9IGQzLm1lYW4oY29vcmRzLCBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgcmV0dXJuIGRbMF07XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbGV0IGNlbnRlcl95ID0gZDMubWVhbihjb29yZHMsIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICByZXR1cm4gZFsxXTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbGV0IHRlYW0gPSBkMy5zZXQoKTtcclxuICAgICAgICBncm91cC5mb3JFYWNoKGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICB0ZWFtLmFkZChkW1widGVhbTFcIl0pO1xyXG4gICAgICAgICAgdGVhbS5hZGQoZFtcInRlYW0yXCJdKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgIGF0dGVuZGFuY2U6IHRvdGFsLFxyXG4gICAgICAgICAgeDogY2VudGVyX3gsXHJcbiAgICAgICAgICB5OiBjZW50ZXJfeSxcclxuICAgICAgICAgIHRlYW1zOiB0ZWFtLFxyXG4gICAgICAgICAgaG9tZTogZ3JvdXBbMF0uaG9tZSxcclxuICAgICAgICAgIHllYXI6IGdyb3VwWzBdLnllYXIsXHJcbiAgICAgICAgICB0ZWFtTnVtYmVyOiB0ZWFtLnNpemUoKVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgLmVudHJpZXMoZGF0YSk7XHJcbiAgfVxyXG5cclxuXHJcbiAgLy8g5qC55o2u5LiW55WM5p2v5Y6G5Y+y5pWw5o2u5Zyo5Zyw5Zu+5LiK5qCH5Ye65L2N572uXHJcbiAgZnVuY3Rpb24gcGxvdF9wb2ludChkYXRhKSB7XHJcbiAgICAvLyBUaGlzIGlzIHRoZSBtYWluIGRhdGEgd2UgbmVlZC5cclxuICAgIGxldCBuZXN0ZWQgPSBuZXN0ZWREYXRhKGRhdGEpO1xyXG5cclxuICAgIHBvaW50LmluaXQobmVzdGVkLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgICAgcmV0dXJuIGIudmFsdWUuYXR0ZW5kYW5jZSAtIGEudmFsdWUuYXR0ZW5kYW5jZTtcclxuICAgIH0pLCBmdW5jdGlvbiAoZCkge1xyXG4gICAgICByZXR1cm4gZFtcImtleVwiXTtcclxuICAgIH0sIGZ1bmN0aW9uIChwb2ludHMpIHtcclxuICAgICAgcG9pbnRzXHJcbiAgICAgICAgLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICB0b29sdGlwLnVwZGF0ZShkMy5ldmVudC5wYWdlWCwgZDMuZXZlbnQucGFnZVksIGQpO1xyXG4gICAgICAgICAgbGV0IGZpbHRlcmVkID0gbmVzdGVkLmZpbHRlcihmdW5jdGlvbiAoZDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGQxW1wia2V5XCJdKS5nZXRGdWxsWWVhcigpID09PSBwYXJzZUludChkLmtleSk7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIG1hcC5oaWdobGlnaHQoZmlsdGVyZWRbMF0udmFsdWVbXCJ0ZWFtc1wiXSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJtb3VzZW1vdmVcIiwgZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICAgIHRvb2x0aXAubW92ZShkMy5ldmVudC5wYWdlWCwgZDMuZXZlbnQucGFnZVkpXHJcbiAgICAgICAgfSlcclxuICAgICAgICAub24oXCJtb3VzZW91dFwiLCBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgdG9vbHRpcC5vZmYoKTtcclxuICAgICAgICAgIG1hcC5yZXNldCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIGxldCB5ZWFycyA9IHBvcHVsYXRlX3llYXIoMTkzMCwgMjAxNSwgNCk7XHJcblxyXG4gICAgZDMuc2VsZWN0KFwiI3Zpcy1ib3hcIilcclxuICAgICAgLmFwcGVuZChcInVsXCIpXHJcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJidXR0b25fX2xpc3Qtcm93XCIpXHJcbiAgICAgIC5zZWxlY3RBbGwoXCJsaVwiKVxyXG4gICAgICAuZGF0YSh5ZWFycylcclxuICAgICAgLmVudGVyKClcclxuICAgICAgLmFwcGVuZChcImxpXCIpXHJcbiAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJidXR0b25cIilcclxuICAgICAgLmFwcGVuZChcImJ1dHRvblwiKVxyXG4gICAgICAudGV4dChmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgIHJldHVybiBkO1xyXG4gICAgICB9KVxyXG4gICAgICAub24oXCJtb3VzZW92ZXJcIiwgZnVuY3Rpb24gKGQpIHtcclxuICAgICAgICBsZXQgZmlsdGVyZWQgPSBuZXN0ZWQuZmlsdGVyKGZ1bmN0aW9uIChkMSkge1xyXG4gICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGQxW1wia2V5XCJdKS5nZXRGdWxsWWVhcigpID09PSBkO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBtYXAuaGlnaGxpZ2h0KGZpbHRlcmVkWzBdLnZhbHVlW1widGVhbXNcIl0pO1xyXG4gICAgICAgIHBvaW50LnJlbmRlcihmaWx0ZXJlZCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICBtYXAucmVzZXQoKTtcclxuICAgICAgICBwb2ludC5yZW5kZXIobmVzdGVkKVxyXG4gICAgICAgICAgLm9uKFwibW91c2VvdmVyXCIsIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICAgIHRvb2x0aXAudXBkYXRlKGQzLmV2ZW50LnBhZ2VYLCBkMy5ldmVudC5wYWdlWSwgZCk7XHJcbiAgICAgICAgICAgIGxldCBmaWx0ZXJlZCA9IG5lc3RlZC5maWx0ZXIoZnVuY3Rpb24gKGQxKSB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBEYXRlKGQxW1wia2V5XCJdKS5nZXRGdWxsWWVhcigpID09PSBwYXJzZUludChkLmtleSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBtYXAuaGlnaGxpZ2h0KGZpbHRlcmVkWzBdLnZhbHVlW1widGVhbXNcIl0pO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5vbihcIm1vdXNlbW92ZVwiLCBmdW5jdGlvbiAoZCkge1xyXG4gICAgICAgICAgICB0b29sdGlwLm1vdmUoZDMuZXZlbnQucGFnZVgsIGQzLmV2ZW50LnBhZ2VZKVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5vbihcIm1vdXNlb3V0XCIsIGZ1bmN0aW9uIChkKSB7XHJcbiAgICAgICAgICAgIHRvb2x0aXAub2ZmKCk7XHJcbiAgICAgICAgICAgIG1hcC5yZXNldCgpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZHJhdyhnZW9fanNvbikge1xyXG4gICAgbWFwLmluaXQoZ2VvX2pzb24pO1xyXG4gICAgbGV0IGZvcm1hdCA9IGQzLnRpbWVQYXJzZShcIiVkLSVtLSVZICglSDolTSBoKVwiKTtcclxuXHJcbiAgICBkMy50c3YoXCIuLi9hc3NldHMvd29ybGRfY3VwX2dlby50c3ZcIiwgZnVuY3Rpb24gKGQpIHtcclxuICAgICAgbGV0IGRhdGUgPSBmb3JtYXQoZFtcImRhdGVcIl0pO1xyXG4gICAgICBkW1wiYXR0ZW5kYW5jZVwiXSA9ICtkW1wiYXR0ZW5kYW5jZVwiXTtcclxuICAgICAgZFtcImRhdGVcIl0gPSBkYXRlO1xyXG4gICAgICByZXR1cm4gZDtcclxuICAgIH0pLnRoZW4oZGF0YSA9PiB7XHJcbiAgICAgIHBsb3RfcG9pbnQoZGF0YSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vIOiOt+WPlmdlb0pzb27lnLDlm77mlbDmja5cclxuICBkMy5qc29uKFwiLi4vYXNzZXRzL3dvcmxkX2NvdW50cmllcy5qc29uXCIpLnRoZW4oZGF0YSA9PiB7XHJcbiAgICBkcmF3KGRhdGEpO1xyXG4gIH0pO1xyXG59KSgpO1xyXG4iXSwic291cmNlUm9vdCI6IiJ9